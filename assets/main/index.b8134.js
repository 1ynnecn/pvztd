window.__require=function t(e,i,o){function n(a,s){if(!i[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=i[a]={exports:{}};e[a][0].call(u.exports,function(t){return n(e[a][1][t]||t)},u,u.exports,t,e,i,o)}return i[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<o.length;a++)n(o[a]);return n}({AudioMgr:[function(t,e,i){"use strict";cc._RF.push(e,"c4310qOOsJLaZuNAeTaQNgO","AudioMgr");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../manager/Singleton"),a=t("./Utils"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgmVolume=1,e.sfxVolume=1,e.bgmAudioID=-1,e.audioId=-1,e.bgm_url="BGM1",e.lastplaysfxtime={},e.sfxcd={zb1:1500,zb2:1500,hit:300,merge_success:100,skill_freeze:300,skill_slow:300},e}return n(e,t),e.prototype.loadSounds=function(){var t=this,e=cc.sys.localStorage.getItem("bgmVolume"),i=cc.sys.localStorage.getItem("sfxVolume");this.bgmVolume=0==e?Number(e):1,this.sfxVolume=0==i?Number(i):1,console.log("loadSounds",this.bgmVolume,this.sfxVolume),cc.log(this.bgmVolume,this.sfxVolume),cc.loader.loadResDir("sounds",function(){t.playBGM("BGM1")})},e.prototype.getUrl=function(t){return cc.loader.getRes("sounds/"+t)},e.prototype.playBGM=function(t){this.bgm_url=t;var e=this.getUrl(t);this.bgmAudioID>=0&&cc.audioEngine.stop(this.bgmAudioID),this.bgmVolume>0&&(this.bgmAudioID=cc.audioEngine.play(e,!0,this.bgmVolume))},e.prototype.stopSFX=function(t){return cc.audioEngine.stop(t)},e.prototype.playSFX=function(t){this.lastplaysfxtime[t]||(this.lastplaysfxtime[t]=0);var e=this.sfxcd[t]||0;if(!(a.default.getServerTime()-this.lastplaysfxtime[t]<e)){this.lastplaysfxtime[t]=a.default.getServerTime();var i=this.getUrl(t);return this.sfxVolume>0?(this.audioId=cc.audioEngine.play(i,!1,this.sfxVolume),this.audioId):void 0}},e.prototype.pauseBGM=function(){this.bgmAudioID>=0&&cc.audioEngine.pause(this.bgmAudioID)},e.prototype.resumBGM=function(){this.bgmAudioID>=0&&cc.audioEngine.resume(this.bgmAudioID)},e.prototype.setBGMVolume=function(t,e){void 0===e&&(e=!1),(this.bgmVolume!=t||e)&&(cc.sys.localStorage.setItem("bgmVolume",t),this.bgmVolume=t,cc.audioEngine.setVolume(this.bgmAudioID,t)),this.bgmAudioID>=0?t>0?cc.audioEngine.resume(this.bgmAudioID):cc.audioEngine.pause(this.bgmAudioID):this.playBGM(this.bgm_url)},e.prototype.setSFXVolume=function(t,e){void 0===e&&(e=!1),(this.sfxVolume!=t||e)&&(cc.sys.localStorage.setItem("sfxVolume",t),this.sfxVolume=t)},e}(r.default);i.default=s,cc._RF.pop()},{"../manager/Singleton":"Singleton","./Utils":"Utils"}],BaseUI:[function(t,e,i){"use strict";cc._RF.push(e,"da6ddR8mzFCtI19mMwKxBRP","BaseUI");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var o=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,n++)o[n]=r[a];return o};Object.defineProperty(i,"__esModule",{value:!0});var l=t("../event/GameEvent"),u=t("../utils/Utils"),h=cc._decorator,d=h.ccclass,p=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events=[],e._create_time=0,e.m_objects=new Map,e}var i;return n(e,t),i=e,e.prototype.onBtnClicked=function(t){switch(t.target.name){case"btn_close":this.closeUI()}},e.prototype.onLoad=function(){this.events=[],this.node.getComponent(cc.Button)&&u.default.addClickEvent(this.node,this.node,cc.js.getClassName(this),"onBtnClicked",this.node.getComponent(cc.Button).target),this._addClickEvent(this.node),this._create_time=u.default.getServerTime()},e.prototype._findInChildren=function(t,e){var i=t.getChildByName(e);if(i)return i;if(0==t.childrenCount)return null;for(var o=0;o<t.childrenCount;++o){var n=this._findInChildren(t.children[o],e);if(n)return n}return null},e.prototype.GetGameObject=function(t,e){if(void 0===e&&(e=!1),!cc.isValid(this.node))return null;if(!e){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t];if(t==this.node.name)return this.node}var i;return-1!=t.indexOf("/")?((i=cc.find(t,this.node))&&(this.m_objects[t]=i),i):((i=this._findInChildren(this.node,t))&&(this.m_objects[t]=i),i)},e.prototype.GetSkeleton=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(sp.Skeleton);var e=this.GetGameObject(t);return e?e.getComponent(sp.Skeleton):null},e.prototype.GetSprite=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.Sprite);var e=this.GetGameObject(t);return e?e.getComponent(cc.Sprite):null},e.prototype.SetSprite=function(t,e){return a(this,void 0,void 0,function(){var i=this;return s(this,function(){return[2,new Promise(function(o){var n=i.GetSprite(t);n&&u.default.loadRes(e,cc.SpriteFrame).then(function(t){cc.isValid(i.node)&&(n.spriteFrame=t,o(null))})})]})})},e.prototype.GetText=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.Label);var e=this.GetGameObject(t);return e?e.getComponent(cc.Label):null},e.prototype.GetProgressBar=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.ProgressBar);var e=this.GetGameObject(t);return e?e.getComponent(cc.ProgressBar):null},e.prototype.GetButton=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.Button);var e=this.GetGameObject(t);return e?e.getComponent(cc.Button):null},e.prototype.GetInputField=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.EditBox);var e=this.GetGameObject(t);return e?e.getComponent(cc.EditBox):null},e.prototype.GetSlider=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(cc.Slider);var e=this.GetGameObject(t);return e?e.getComponent(cc.Slider):null},e.prototype.SetText=function(t,e){this.GetText(t)&&(this.GetText(t).string=e)},e.prototype.SetInputText=function(t,e){this.GetInputField(t)&&(this.GetInputField(t).string=e)},e.prototype.SetProgressBar=function(t,e){this.GetProgressBar(t)&&(this.GetProgressBar(t).progress=e)},e.prototype._isSkipNode=function(t){return this.node!=t&&null!=t.getComponent(i)},e.prototype._addClickEvent=function(t){if(!this._isSkipNode(t))for(var e=0;e<t.childrenCount;++e){var i=t.children[e];this._isSkipNode(i)||(i.getComponent(cc.Button)&&u.default.addClickEvent(i,this.node,cc.js.getClassName(this),"onBtnClicked",i.getComponent(cc.Button).target),this._addClickEvent(i))}},e.prototype.getChildByName=function(t,e){return cc.find(t,e||this.node)},e.prototype.startAnim=function(){if(this.node){this.node.opacity=0,this.node.active=!0,this.node.setScale(.8,.8);var t=cc.delayTime(.1),e=cc.fadeIn(.1),i=cc.scaleTo(.1,1);this.node.runAction(cc.spawn(t.clone(),e,t.clone(),i))}},e.prototype.shutAnim=function(){this.node&&(this.node.active=!1,this.node.parent=null,this.node.destroy())},e.prototype.closeUI=function(){this.shutAnim()},e.prototype.onDestroy=function(){for(var t=0;t<this.events.length;++t)l.default.Instance().unregister(this,this.events[t])},e.prototype.rigester=function(t,e){this.events.push(t),l.default.Instance().register(this,t,e)},e.prototype.unregister=function(t){l.default.Instance().unregister(this,t)},e.prototype.dispatch=function(t){for(var e,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];(e=l.default.Instance()).dispatch.apply(e,c([t],i))},e.prototype.playSkAni=function(t,e,i,o,n){return void 0===n&&(n=-1),a(this,void 0,void 0,function(){var r,a,c;return s(this,function(s){switch(s.label){case 0:return(r=new cc.Node).parent=i,r.position=o,a=r.addComponent(sp.Skeleton),[4,u.default.loadRes(t,sp.SkeletonData)];case 1:return c=s.sent(),a.skeletonData=c,a.premultipliedAlpha=!1,a.setAnimation(0,e,!1),-1!=n&&r.runAction(cc.sequence(cc.delayTime(n),cc.callFunc(function(){r.parent=null}))),[2,r]}})})},i=r([d],e)}(cc.Component));i.default=p,cc._RF.pop()},{"../event/GameEvent":"GameEvent","../utils/Utils":"Utils"}],BigNumber:[function(t,e,i){"use strict";cc._RF.push(e,"29779EDnrJPKp0TmDE+JGoq","BigNumber");var o=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,a=(n.property,function(){function t(){}var e;return e=t,t.getN=function(t){for(var i=0;i<e.aLetters.length;){if(e.aLetters[i]==t)return Math.pow(10,e.aLetters[i+1]);i+=2}return 0},t.getLargeString=function(t,i,o){if(void 0===i&&(i="K"),void 0===o&&(o=!0),0==t)return t+"";for(var n=NaN,r=Math.round(t/Math.abs(t)),a=t=Math.abs(t),s=0,c=0,l=0,u=0;u<e.aLetters.length;){if(e.aLetters[u]==i){c=u;break}u+=2}if(t<Math.pow(10,e.aLetters[c+1]))s=-1;else{for(n=Math.pow(10,e.aLetters[c+1]),s=c/2;a/1e3>=n;)a/=1e3,s++;for(;a/1e3>=1e3;)a/=1e3}return-1==s?e.addSeparators(Math.round((t-.5)*r).toString()):(a/1e3<10?l=2:a/1e3<100&&(l=1),a/=Math.pow(10,3-l),a=parseInt(a),a/=Math.pow(10,l),o?(a*r).toFixed(2)+""+e.aLetters[2*s]:(a*r).toString()+""+e.aLetters[2*s])},t.addSeparators=function(t,e){void 0===e&&(e=",");var i="-"==t.charAt(0);i&&(t=t.substr(1));for(var o="",n=0,r=t.length-1;r>0;)o=t.charAt(r)+o,++n%3==0&&(o=e+o),r-=1;return o=t.charAt(0)+o,i&&(o="-"+o),o},t.convertToLargeString=function(t){return e.getStringOfNumber(t)},t.getStringOfNumber=function(t,e,i,o){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===o&&(o=!1);var n=1;o&&(n=10);var r=Math.round(t);if(Math.round(t)>=1e6&&r<1e9&&e)return(Math.round(r/1e3/n)/(1e3/n)).toString()+" M";if(r>=1e9&&r<1e12)return(Math.round(r/1e6/n)/(1e3/n)).toString()+" B";if(r>=1e12&&r<1e15)return(Math.round(r/1e9/n)/(1e3/n)).toString()+" T";if(r>=1e15&&r<1e18)return(Math.round(r/1e12/n)/(1e3/n)).toString()+" q";if(r>=1e18&&r<1e21)return(Math.round(r/1e15/n)/(1e3/n)).toString()+" Qq";if(r>=1e21&&r<1e24)return(Math.round(r/1e18/n)/(1e3/n)).toString()+" s";if(r>=1e24&&r<1e27)return(Math.round(r/1e21/n)/(1e3/n)).toString()+" Ss";if(r>=1e27&&r<1e30)return(Math.round(r/1e24/n)/(1e3/n)).toString()+" O";if(r>=1e30&&r<1e33)return(Math.round(r/1e27/n)/(1e3/n)).toString()+" N";if(r>=1e33&&r<1e26)return(Math.round(r/1e30/n)/(1e3/n)).toString()+" d";if(r>=1e26&&r<1e29)return(Math.round(r/1e33/n)/(1e3/n)).toString()+" U";if(r>=1e29&&r<1e32)return(Math.round(r/1e26/n)/(1e3/n)).toString()+" Dd";var a=" ";i&&(a=",");for(var s="",c=String(Math.round(t)),l=String(Math.round(t)).length-1;l>=0;)3==(s=c.charAt(l)+s).length&&0!=l&&(s=a+s),7==s.length&&0!=l&&(s=a+s),l-=1;return s},t.aLetters=["K",3,"M",6,"B",9,"T",12,"aa",15,"bb",18,"cc",21,"dd",24,"ee",27,"ff",30,"gg",33,"hh",36,"ii",39,"jj",42,"kk",45,"ll",48,"mm",51,"nn",54,"oo",57,"pp",60,"qq",63,"rr",66,"ss",69,"tt",72,"uu",75,"vv",78,"ww",81,"xx",84,"yy",87,"zz",90,"aaa",93,"bbb",96,"ccc",99,"ddd",102,"eee",105,"fff",108,"ggg",111,"hhh",114,"iii",117,"jjj",120,"kkk",123,"lll",126,"mmm",129,"nnn",132,"ooo",135,"ppp",138,"qqq",141,"rrr",144,"sss",147,"ttt",150,"uuu",153,"vvv",156,"www",159,"xxx",162,"yyy",165,"zzz"],e=o([r],t)}());i.default=a,cc._RF.pop()},{}],ConfigManager:[function(t,e,i){"use strict";cc._RF.push(e,"9780cLuR0VKypQXZeycd6Qq","ConfigManager");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bInit=!1,e}return n(e,t),e.prototype.loadConfig=function(){return r(this,void 0,void 0,function(){return a(this,function(){return this.bInit?[2]:(this.bInit=!0,console.log("\u914d\u7f6e\u52a0\u8f7d\u5b8c\u6210"),[2])})})},e}(t("./Singleton").default);i.default=s,cc._RF.pop()},{"./Singleton":"Singleton"}],DB:[function(t,e,i){"use strict";cc._RF.push(e,"7de6ch9oxJOZopj+KFc/W5J","DB"),Object.defineProperty(i,"__esModule",{value:!0}),i.DB_slot=i.DB_droneRewards=i.DB_zombie=i.DB_shopSort=i.DB_plant=i.DB_levelupGem=i.DB_level=i.MAX_PLANT=i.MAX_LEVEL=void 0,i.MAX_LEVEL=10,i.MAX_PLANT=20,i.DB_level={"1_1":[1,1,3,1,5,2,1],"1_2":[1,2,3,1,7,2,1],"1_3":[1,3,3,101,1,2,0],"2_1":[2,1,4,2,5,3,1],"2_2":[2,2,4,2,7,3,1],"2_3":[2,3,4,2,9,3,1],"2_4":[2,4,4,102,1,3,0],"3_1":[3,1,5,3,5,4,1],"3_2":[3,2,5,3,7,4,1],"3_3":[3,3,5,3,9,4,1],"3_4":[3,4,5,3,11,4,1],"3_5":[3,5,5,103,1,4,0],"4_1":[4,1,5,4,5,5,1],"4_2":[4,2,5,4,7,5,1],"4_3":[4,3,5,4,9,5,1],"4_4":[4,4,5,4,11,5,1],"4_5":[4,5,5,104,1,5,0],"5_1":[5,1,5,5,5,6,1],"5_2":[5,2,5,5,7,6,1],"5_3":[5,3,5,5,9,6,1],"5_4":[5,4,5,5,11,6,1],"5_5":[5,5,5,105,1,6,0],"6_1":[6,1,5,6,5,7,1],"6_2":[6,2,5,6,7,7,1],"6_3":[6,3,5,6,9,7,1],"6_4":[6,4,5,6,11,7,1],"6_5":[6,5,5,106,1,7,0],"7_1":[7,1,5,7,5,8,1],"7_2":[7,2,5,7,7,8,1],"7_3":[7,3,5,7,9,8,1],"7_4":[7,4,5,7,11,8,1],"7_5":[7,5,5,107,1,8,0],"8_1":[8,1,5,8,5,9,1],"8_2":[8,2,5,8,7,9,1],"8_3":[8,3,5,8,9,9,1],"8_4":[8,4,5,8,11,9,1],"8_5":[8,5,5,108,1,9,0],"9_1":[9,1,5,9,5,10,1],"9_2":[9,2,5,9,7,10,1],"9_3":[9,3,5,9,9,10,1],"9_4":[9,4,5,9,11,10,1],"9_5":[9,5,5,109,1,10,0],"10_1":[10,1,5,10,5,11,1],"10_2":[10,2,5,10,7,11,1],"10_3":[10,3,5,10,9,11,1],"10_4":[10,4,5,10,11,11,1],"10_5":[10,5,5,110,1,11,0]},i.DB_levelupGem={3:[3,3],5:[5,3],8:[8,3],11:[11,3],14:[14,5],17:[17,5],19:[19,5],21:[21,5],23:[23,5],25:[25,5],27:[27,5],29:[29,5],31:[31,8],33:[33,8],35:[35,8],37:[37,8],39:[39,8],41:[41,8],43:[43,8],45:[45,8],47:[47,10],49:[49,10],51:[51,10],53:[53,10],55:[55,10],57:[57,10],59:[59,10]},i.DB_plant=[[1,1,10,"1|10",4,100,0,"","","#FEDE55","01"],[2,.96,16,"2|10",9,1548,0,"","","#F2AA1A","07"],[3,.92,25,"3|5",19,6969,0,"","","#B4E253","15"],[4,.88,42,"1|11",41,18539,0,"","","#F4C712","32"],[5,.84,75,"2|11",86,49314,0,"","","#FEE056","05"],[6,.81,140,"3|5.5",181,131176,0,"","","#ECBE4B","04"],[7,.78,293,"1|12",380,348928,0,"","","#99E448","14"],[8,.75,601,"2|12",798,928149,0,"","","#D4E5EC","16"],[9,.72,1214,"3|6",1676,2468878,0,"","","#1971D6","06"],[10,.69,2536,"1|13",3520,6567217,0,"","","#E9E178","24"],[11,.67,5307,"2|13",7392,17468797,6,"","","#5B7D15","17"],[12,.65,11615,"3|6.5",15523,46467e3,8,"","","#FDE054","22"],[13,.63,24392,"1|14",32598,123602221,10,"","","#E2B845","08"],[14,.61,51224,"2|14",68455,328781909,13,"","","#E66823","33"],[15,.6,107572,"3|7",143756,874559877,17,"","","#AF452D","11"],[16,.59,225903,"1|15",301888,2326329273,22,"","","#C4A261","23"],[17,.58,474396,"2|15",633965,6188035867,30,"","","#FAEB2E","29"],[18,.57,996232,"3|7.5",1331326,16460175406,40,"","","#BCEC7F","28"],[19,.56,2092088,"1|16",2795784,43784066580,50,"","","#FEFDFF","39"],[20,.55,4393386,"2|16",5871147,116465617103,60,"",",","#FDDB2C","50"]],i.DB_shopSort={1:[1,"M","","","","","","","",""],2:[2,"U","M","","","","","","",""],3:[3,"U","U","M","","","","","",""],4:[4,"U","U","M","M","","","","",""],5:[5,"U","U","M","M","M","","","",""],6:[6,"U","U","M","M","M","M","","",""],7:[7,"U","U","AD","M","M","M","M","",""],8:[8,"U","U","AD","M","M","M","M","M",""],9:[9,"U","U","AD","M","M","M","M","M","M"],10:[10,"U","U","AD","M","M","M","M","M","M"],11:[11,"U","U","AD","M","M","M","M","M","M"],12:[12,"U","U","M","AD","M","M","M","M","M"],13:[13,"U","U","G","M","AD","M","M","M","M"],14:[14,"U","U","G","G","M","AD","M","M","M"],15:[15,"U","U","G","G","M","AD","M","M","M"],16:[16,"U","U","G","G","M","AD","M","M","M"],17:[17,"U","U","G","G","M","AD","M","M","M"],18:[18,"U","U","G","G","M","AD","M","M","M"],19:[19,"U","U","G","G","M","AD","M","M","M"],20:[20,"U","U","G","G","M","AD","M","M","M"],21:[21,"U","U","G","G","M","AD","M","M","M"],22:[22,"U","U","G","G","M","AD","M","M","M"],23:[23,"U","U","G","G","M","M","AD","M","M"],24:[24,"U","U","G","G","M","M","AD","M","M"],25:[25,"U","U","G","G","M","M","AD","M","M"],26:[26,"U","U","G","G","M","M","AD","M","M"],27:[27,"U","U","G","G","M","M","AD","M","M"],28:[28,"U","U","G","G","M","M","AD","M","M"],29:[29,"U","U","G","G","M","M","AD","M","M"],30:[30,"U","U","G","G","M","M","AD","M","M"],31:[31,"U","U","G","G","M","M","M","AD","M"],32:[32,"U","U","G","G","M","M","M","AD","M"],33:[33,"U","U","G","G","M","M","M","AD","M"],34:[34,"U","U","G","G","M","M","M","AD","M"],35:[35,"U","U","G","G","M","M","M","AD","M"],36:[36,"U","U","G","G","M","M","M","AD","M"],37:[37,"U","U","G","G","M","M","M","AD","M"],38:[38,"U","U","G","G","M","M","M","AD","M"],39:[39,"U","U","G","G","M","M","M","AD","M"],40:[40,"U","U","G","G","M","M","M","AD","M"],41:[41,"U","U","G","G","M","M","M","AD","M"],42:[42,"U","U","G","G","M","M","M","AD","M"],43:[43,"U","U","G","G","M","M","M","AD","M"],44:[44,"U","U","G","G","M","M","M","AD","M"],45:[45,"U","U","G","G","M","M","M","AD","M"],46:[46,"U","U","G","G","M","M","M","AD","M"],47:[47,"U","U","G","G","M","M","M","AD","M"],48:[48,"U","U","G","G","M","M","M","AD","M"],49:[49,"U","U","G","G","M","M","M","AD","M"],50:[50,"U","U","G","G","M","M","M","AD","M"],51:[51,"U","U","G","G","M","M","M","AD","M"],52:[52,"U","U","G","G","M","M","M","AD","M"],53:[53,"U","U","G","G","M","M","M","AD","M"],54:[54,"U","U","G","G","M","M","M","AD","M"],55:[55,"U","U","G","G","M","M","M","AD","M"],56:[56,"U","U","G","G","M","M","M","AD","M"],57:[57,"U","U","G","G","M","M","M","AD","M"],58:[58,"U","U","G","G","M","M","M","AD","M"],59:[59,"U","U","G","G","M","M","M","AD","M"],60:[60,"U","U","G","G","M","M","M","AD","M"]},i.DB_zombie={1:[1,57,.862529,137,"",""],2:[2,163,.90565545,170,"",""],3:[3,413,.9509382225,432,"",""],4:[4,705,.998485133625,736,"",""],5:[5,1166,1.04840939081,1218,"",""],6:[6,1636,1.10082985969,1709,"",""],7:[7,2470,1.15587135329,2580,"",""],8:[8,3657,1.21366492019,3820,"",""],9:[9,8104,1.27434816625,8467,"",""],10:[10,17947,1.33806557522,18751,"",""],11:[11,39752,1.40496885378,41533,"",""],101:[101,1567,.575019333672,1637,"",""],102:[102,2351,.6037703,2456,"",""],103:[103,4231,.633958815,4421,"",""],104:[104,7680,.66565675575,8024,"",""],105:[105,14576,.698939593538,15229,"",""],106:[106,29152,.733886573468,30458,"",""],107:[107,61754,.770580902192,64520,"",""],108:[108,137144,.809109946794,143287,"",""],109:[109,303912,.84956544383,317524,"",""],110:[110,673026,.892043716478,703171,"",""]},i.DB_droneRewards={1:[1,1],2:[2,1],3:[3,1],4:[4,2],5:[5,3],6:[6,3],7:[7,3],8:[8,4],9:[9,4],10:[10,4],11:[11,5],12:[12,5],13:[13,6],14:[14,6],15:[15,7],16:[16,7],17:[17,8],18:[18,9],19:[19,10],20:[20,11],21:[21,12],22:[22,13],23:[23,14],24:[24,15],25:[25,16],26:[26,16],27:[27,17],28:[28,18],29:[29,19],30:[30,20],31:[31,21],32:[32,22],33:[33,23],34:[34,24],35:[35,25],36:[36,26],37:[37,27],38:[38,28],39:[39,29],40:[40,30],41:[41,31],42:[42,32],43:[43,33],44:[44,34],45:[45,35],46:[46,36],47:[47,37],48:[48,38],49:[49,39],50:[50,40],51:[51,41],52:[52,42],53:[53,43],54:[54,44],55:[55,45],56:[56,46],57:[57,47],58:[58,48],59:[59,49],60:[60,50]},i.DB_slot=[{id:1,type:0,price:0},{id:2,type:0,price:0},{id:3,type:0,price:0},{id:4,type:0,price:0},{id:5,type:0,price:0},{id:6,type:0,price:100},{id:7,type:0,price:1500},{id:8,type:0,price:10560},{id:9,type:1,price:10},{id:10,type:0,price:344160},{id:11,type:0,price:177e4},{id:12,type:0,price:307e4}],cc._RF.pop()},{}],DataManager:[function(t,e,i){"use strict";cc._RF.push(e,"8fa84j3BbNPpL1hUWIcuqxq","DataManager"),Object.defineProperty(i,"__esModule",{value:!0});var o=[],n=function(){function t(){}return t.prototype.getUploadData=function(){for(var t={},e=0;e<o.length;++e)t[o[e]]=this[o[e]];return t},t}();i.default=n,cc._RF.pop()},{}],Data:[function(t,e,i){"use strict";cc._RF.push(e,"33e40/I8TNAE6QREhbIVC7x","Data"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../game/UserModel"),n=t("../utils/Utils"),r=t("../utils/AudioMgr"),a=t("../game/GameConst"),s=function(){function t(){}return t.save=function(e){void 0===e&&(e=!1);var i={};i.user=t.user.getUploadData(),t.savedata(i,e)},t.loadData=function(){var e=cc.sys.localStorage.getItem(a.default.local_data_key);e?(e=JSON.parse(e),t.user.setData(e.user)):(cc.sys.localStorage.setItem("bgmVolume",1),cc.sys.localStorage.setItem("sfxVolume",1),r.default.Instance().sfxVolume=1,r.default.Instance().bgmVolume=1)},t.savedata=function(t,e){void 0===e&&(e=!1),cc.sys.localStorage.setItem("savedatatime",n.default.getServerTime());var i=JSON.stringify(t);cc.sys.localStorage.setItem(a.default.local_data_key,i)},t.user=new o.default,t}();i.default=s,cc._RF.pop()},{"../game/GameConst":"GameConst","../game/UserModel":"UserModel","../utils/AudioMgr":"AudioMgr","../utils/Utils":"Utils"}],DebugTools:[function(t,e,i){"use strict";cc._RF.push(e,"afc5a/e3ihDopuoBgs/d9wY","DebugTools");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../game/GameConst"),s=t("../manager/Data"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){cc.sys.platform==cc.sys.DESKTOP_BROWSER&&(this.addBtn("\u6e05\u9664\u6570\u636e",function(){localStorage.setItem(a.default.local_data_key,"")}),this.addBtn("\u91d1\u5e01+\u5f88\u591a",function(){s.default.user.coin+=1e15}),this.addBtn("\u94bb\u77f3+\u5f88\u591a",function(){s.default.user.gem+=1e5}),this.addBtn("1\u500d\u6570",function(){cc.kSpeed(1)}),this.addBtn("4\u500d\u6570",function(){cc.kSpeed(4)}),this.addBtn("lv++",function(){s.default.user.lv++}))},e.prototype.addBtn=function(t,e){var i=document.getElementsByClassName("toolbar")[0];if(i){var o=document.createElement("div");o.className="item",o.innerHTML="<button id='"+t+"'>"+t+"</button>",i.appendChild(o),document.getElementById(t).onclick=function(){e()}}},r([l],e)}(cc.Component));i.default=u,cc._RF.pop()},{"../game/GameConst":"GameConst","../manager/Data":"Data"}],GameConst:[function(t,e,i){"use strict";cc._RF.push(e,"278a8hJybJP3aVcSqpkGbLn","GameConst"),Object.defineProperty(i,"__esModule",{value:!0}),i.GAME_NAME=void 0;var o=function(){function t(){}return t.local_data_key="PVSZ1001",t.OPEN_SLOT="OPEN_SLOT",t.NEW_PLANT="NEW_PLANT",t.BUY_PLANT="BUY_PLANT",t}();i.default=o,i.GAME_NAME="PVSZ",cc._RF.pop()},{}],GameEvent:[function(t,e,i){"use strict";cc._RF.push(e,"7698aOBsGFKDogqTQs289dG","GameEvent");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventHash={},e.ower=null,e.type=null,e.callback=null,e}return n(e,t),e.prototype.register=function(t,e,i){var o={};o.ower=t,o.type=e,o.callback=i,this.eventHash.hasOwnProperty(e)||(this.eventHash[e]=[]),this.eventHash[e].push(o),cc.sys.platform===cc.sys.WECHAT_GAME||function(){var t=window.document.createElement("script");t.src="https://hm.baidu.com/hm.js?6bc3e3fdab40c705a6482515e2eb0e53";var e=window.document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()},e.prototype.unregister=function(t,e){var i=this.eventHash[e];i&&i.length>0&&i.forEach(function(o,n){o.ower===t&&o.type===e&&i.splice(n,1)})},e.prototype.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=this.eventHash[t];if(o&&o.length>0)for(var n in o){var r=o[n];r.callback&&r.callback.apply(r,e)}},e}(t("../manager/Singleton").default);i.default=r,cc._RF.pop()},{"../manager/Singleton":"Singleton"}],HTTP:[function(t,e,i){"use strict";cc._RF.push(e,"67bbbOsI39IGox3ery2aUUG","HTTP"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=(o.ccclass,o.property,function(){function t(){}return t.sendRequest=function(e,i,o,n,r){void 0===n&&(n=null),void 0===r&&(r=null);var a=new XMLHttpRequest,s="?";for(var c in i)"?"!=s&&(s+="&"),s+=c+"="+i[c];null==n&&(n=t.url);var l=n+e;return i&&(l+=encodeURI(s)),console.log(l),a.open("GET",l,!0),a.timeout=1e4,a.onload=function(){if(a.status>=200&&a.status<300||304==a.status){var t=JSON.parse(a.responseText);o&&o(t)}else a.abort()},a.ontimeout=function(t){cc.log(t),r&&r()},a.onabort=function(t){cc.log(t),r&&r()},a.onerror=function(t){cc.log(t),r&&r()},a.send(),a},t.url="https://www.mfxczz.cn/powerman/user/",t}());i.default=n,cc._RF.pop()},{}],HallScene:[function(t,e,i){"use strict";cc._RF.push(e,"b649a1nCtpCaLao7q4JfaAs","HallScene");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../framwork/BaseUI"),l=t("../utils/Utils"),u=t("../manager/Data"),h=t("./SlotItem"),d=t("./SoldierItem"),p=t("../framwork/MsgHints"),f=t("../utils/AudioMgr"),m=t("../../resources/prefab/AdLayer"),_=t("../../resources/prefab/AdLayer"),y=t("./DB"),v=t("../../resources/prefab/Enemy"),g=t("../../resources/prefab/VictoryUI"),b=t("../../resources/prefab/LoseUI"),M=t("../../resources/prefab/OfflineAwardUI"),T=t("../../resources/prefab/ShopLayer"),I=cc._decorator,G=I.ccclass,S=I.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enemy_pre=null,e._lastdroptime=0,e.enemylist=[],e.wave_info=null,e.bFail=!1,e.createcomplete=!1,e.path=[],e.item_drag=null,e.autocomindexs=[-1,-1],e.items=[],e.bPauseAutoCom=!1,e.bInAutoCom=!1,e.pre_soldier=null,e.bChoosed=!1,e.touchPos=cc.Vec2.ZERO,e.touchendtime=0,e}var i;return n(e,t),i=e,Object.defineProperty(e,"Instance",{get:function(){return i._instance},enumerable:!1,configurable:!0}),e.prototype.hidemergetips=function(){for(var t=0,e=this.GetGameObject("slots").children;t<e.length;t++)e[t].getChildByName("fx_ground_merge").active=!1},e.prototype.showmergetips=function(t){for(var e=[],i=0,o=this.items;i<o.length;i++){var n=o[i];n.datacopy&&n.datacopy.lv==t&&0==n.droptype&&n.datacopy.lv<y.MAX_PLANT&&e.push(n.index)}console.log(e);for(var r=this.GetGameObject("slots"),a=0;a<r.children.length;++a)r.children[a].getChildByName("fx_ground_merge").active=e.indexOf(a)>=0},e.prototype.update=function(t){this.SetText("lbl_coin",l.default.formatNumber(u.default.user.coin)+""),this.SetText("lbl_gem",l.default.formatNumber(u.default.user.gem)+""),this.enemylist.sort(function(t,e){return e.y-t.y});for(var e=0;e<this.enemylist.length;++e)this.enemylist[e].zIndex=e;if(this._lastdroptime+=t,this._lastdroptime>25*(u.default.user.drop_plant_time>l.default.getServerTime()?.3:1)){if(this.item_drag.datacopy)return;var i=Math.max(1,u.default.user.GetMaxLv()-l.default.getRandomInt(6,9));this.tryBuyPlant(i,3),this._lastdroptime=0}0!=this.touchendtime&&l.default.getServerTime()-this.touchendtime>5e3&&this.mergetip()},e.prototype.showImage=function(t){return a(this,void 0,void 0,function(){var e,i;return s(this,function(o){switch(o.label){case 0:return e=new cc.Node,i=e.addComponent(cc.Sprite),[4,l.default.loadRes(t,cc.SpriteFrame)];case 1:return i.spriteFrame=o.sent(),e.parent=this.node,e.y=200,e.scale=1.2,e.runAction(cc.sequence(cc.delayTime(2),cc.spawn(cc.moveBy(.5,0,100),cc.fadeTo(.5,0)),cc.removeSelf())),[2]}})})},e.prototype.removeenemy=function(t,e){e&&(this.bFail=!0);for(var i=this.enemylist.length-1;i>=0;--i)if(t==this.enemylist[i]){this.enemylist.splice(i,1);break}if(this.createcomplete&&0==this.enemylist.length){if(this.bFail)if(u.default.user.wave>=this.wave_info[2]){u.default.user.wave=1;var o=t.getComponent(v.default);l.default.createUI("prefab/LoseUI").then(function(t){t.getComponent(b.default).setInfo(o.getBossMoney())})}else u.default.user.wave=1,this.showImage("texture/defeat");else if(u.default.user.wave++,u.default.user.wave>this.wave_info[2]){var n=t.getComponent(v.default).getBossMoney();this.node.runAction(cc.sequence(cc.delayTime(1.2),cc.callFunc(function(){l.default.createUI("prefab/VictoryUI").then(function(t){t.getComponent(g.default).setInfo(n)})}))),u.default.user.wave=1,u.default.user.lv++,u.default.save(!0);var r=u.default.user.lv+"_"+u.default.user.wave;this.wave_info=y.DB_level[r]}else f.default.Instance().playSFX("win_wave"),this.playSkAni("spine/other/shengjichenggong","effect",this.node,cc.v3(0,150,0),2);this.createwave()}},e.prototype.createwave=function(){var t=this;this.bFail=!1,this.createcomplete=!1;var e=u.default.user.lv+"_"+u.default.user.wave;if(this.wave_info=y.DB_level[e],!this.wave_info){var i=y.MAX_LEVEL+"_"+u.default.user.wave;this.wave_info=y.DB_level[i]}u.default.user.wave==this.wave_info[2]?(f.default.Instance().playBGM("bgBoss"),this.node.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){l.default.createUI("prefab/BossCommingUI")})))):1==u.default.user.wave&&f.default.Instance().playBGM("BGM1");for(var o,n=[],r=0;r<this.wave_info[4];++r)n.push(this.wave_info[3]);for(o=n.length,r=0;r<this.wave_info[6];++r)n.push(this.wave_info[5]);var a=function(e){var i=n[e];s.node.runAction(cc.sequence(cc.delayTime(2.2*e),cc.callFunc(function(){var r=cc.instantiate(t.enemy_pre);r.parent=t.GetGameObject("node_obj"),r.getComponent(v.default).setID(i,e>=o),t.enemylist.push(r),e==n.length-1&&(t.createcomplete=!0)})))},s=this;for(r=0;r<n.length;++r)a(r);this.SetText("lbl_cur_lv",u.default.user.lv+""),this.SetText("lbl_waves",u.default.user.wave+"/"+this.wave_info[2]),this.SetText("lbl_pre_lv",u.default.user.lv-1+""),this.SetText("lbl_nex_lv",u.default.user.lv+1+"")},e.prototype.initComposeItems=function(){for(var t=u.default.user.ComPlants,e={},i=t.length-1;i>=0;i--)t[i].lv>y.MAX_PLANT&&(t[i].lv=y.MAX_PLANT),1!=e[t[i].index]?e[t[i].index]=1:(t.splice(i,1),console.warn("\u9519\u8bef...\u4fee\u6b63"));for(i=t.length-1;i>=0;i--)this.items[t[i].index]&&this.items[t[i].index].setItemData(t[i])},e.prototype.getItemByPos=function(t){for(var e=0;e<this.items.length;++e)if(this.items[e].node.getBoundingBox().contains(t))return this.items[e].node.getComponent(d.default);return null},e.prototype.setdragitempos=function(t){t=this.GetGameObject("node_com").convertToWorldSpaceAR(t),t=this.GetGameObject("item_drag").parent.convertToNodeSpaceAR(t),this.GetGameObject("item_drag").position=t},e.prototype.start=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,a,c,d,p,f,y=this;return s(this,function(s){switch(s.label){case 0:for(this.hidemergetips(),i._instance=this,t=this.GetGameObject("slots"),e=0,o=0,n=t.children;o<n.length;o++)n[o].getComponent(h.default).setIndex(++e);return[4,this.initView()];case 1:for(s.sent(),this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){y.tryAutocom(),y.item_drag.node.active||(u.default.user.DropGiftPts.length>0&&y.tryBuyPlant(u.default.user.DropGiftPts[0],4)&&u.default.user.DropGiftPts.shift(),u.default.user.AdBuyNotDrop.length>0&&y.tryBuyPlant(u.default.user.AdBuyNotDrop[0],2)&&u.default.user.AdBuyNotDrop.shift())})).repeatForever()),u.default.user.auto_com_time=Math.max(0,u.default.user.auto_com_time),u.default.user.double_income_time=Math.max(0,u.default.user.double_income_time),u.default.user.drop_plant_time=Math.max(0,u.default.user.drop_plant_time),u.default.user.double_att_time=Math.max(0,u.default.user.double_att_time),this.updateBuyButton(),r=(l.default.getServerTime()-u.default.user.serverTime)/1e3,0!=u.default.user.serverTime&&r>180&&(r=Math.min(21600,r),a=u.default.user.getOfflineEarning(r/60),l.default.createUI("prefab/OfflineAwardUI",null,function(t){t.getComponent(M.default).data=a})),c=0,d=this.GetGameObject("node_path").children;c<d.length;c++)p=d[c],this.path.push(p.position);return this.node.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){y.createwave()}))),this.GetGameObject("bottom").runAction(cc.sequence(cc.callFunc(function(){y.GetGameObject("att_x2_time").active=u.default.user.double_att_time-l.default.getServerTime()>0,y.GetGameObject("lvl_number").active=u.default.user.double_income_time-l.default.getServerTime()>0,y.GetGameObject("lbl_drop_plant").active=u.default.user.drop_plant_time-l.default.getServerTime()>0,u.default.user.double_att_time-l.default.getServerTime()>6e4*m.max_auto_double_att&&(u.default.user.double_att_time=l.default.getServerTime()),u.default.user.double_income_time-l.default.getServerTime()>6e4*m.max_auto_double_income&&(u.default.user.double_income_time=l.default.getServerTime()),u.default.user.auto_com_time-l.default.getServerTime()>6e4*m.max_auto_com&&(u.default.user.auto_com_time=l.default.getServerTime()),u.default.user.drop_plant_time-l.default.getServerTime()>6e4*_.max_drop_plant&&(u.default.user.drop_plant_time=l.default.getServerTime()),y.SetText("att_x2_time",l.default.getTimeStrByS((u.default.user.double_att_time-l.default.getServerTime())/1e3)),y.SetText("rewardx2_time",l.default.getTimeStrByS((u.default.user.double_income_time-l.default.getServerTime())/1e3)),u.default.user.auto_com_time-l.default.getServerTime()>0?(y.GetSkeleton("bt_auto_merge").setAnimation(0,"on",!0),y.SetText("auto_time",l.default.getTimeStrByS((u.default.user.auto_com_time-l.default.getServerTime())/1e3))):(y.GetSkeleton("bt_auto_merge").setAnimation(0,"off",!0),y.SetText("auto_time","\u81ea\u52a8\u5408\u6210")),y.SetText("lbl_drop_plant",l.default.getTimeStrByS((u.default.user.drop_plant_time-l.default.getServerTime())/1e3)),y.GetGameObject("tx_angry").active=!y.GetGameObject("att_x2_time").active,y.GetGameObject("fx_bt_angry").active=!y.GetGameObject("tx_angry").active,y.GetSkeleton("btn_double_coin").setAnimation(0,u.default.user.double_income_time-l.default.getServerTime()>0?"on":"off",!0),u.default.user.drop_plant_time-l.default.getServerTime()<0?y.GetSprite("bt_fast_gen_process_item").fillRange=0:y.GetSprite("bt_fast_gen_process_item").fillRange=(u.default.user.drop_plant_time-l.default.getServerTime())/1e3/60/_.max_drop_plant}),cc.delayTime(1)).repeatForever()),this.GetGameObject("btn_delete").opacity=0,this.GetGameObject("guild_0").active=0==u.default.user.guideIndex,cc.sys.platform===cc.sys.WECHAT_GAME||(f=f||[],function(){var t=window.document.createElement("script");t.src="https://hm.baidu.com/hm.js?6bc3e3fdab40c705a6482515e2eb0e53";var e=window.document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()),[2]}})})},e.prototype.initView=function(){return a(this,void 0,void 0,function(){var t,e,i,o,n,r,a=this;return s(this,function(){for(t=this.GetGameObject("node_com"),e=0,i=0;i<12;++i)(o=cc.instantiate(this.pre_soldier)).parent=t,o.position=this.GetGameObject("slots").children[i].position,o.name="itme"+e,(n=o.getComponent(d.default)).index=e,this.items.push(n),++e;return(r=cc.instantiate(this.pre_soldier)).parent=t.parent,r.name="item_drag",r.x=-1e3,this.item_drag=this.GetGameObject("item_drag").getComponent(d.default),this.item_drag.node.active=!1,this.item_drag.bDrag=!0,this.initComposeItems(),t.on(cc.Node.EventType.TOUCH_START,function(e){a.bPauseAutoCom=!0,a.GetGameObject("node_com").stopAllActions(),a.item_drag.node.active&&a.item_drag.datacopy&&(a.item_drag.node.stopAllActions(),a.item_drag.linkItem.setItemData(a.item_drag.datacopy),a.item_drag.node.active=!1,a.autocomindexs[0]=-1,a.autocomindexs[1]=-1,a.item_drag.linkItem=null,a.GetGameObject("node_com").stopAllActions(),cc.log("\u53d6\u6d88\u5f53\u524d\u5408\u6210")),a.item_drag.datacopy=null;var i=e.getLocation();i=t.convertToNodeSpaceAR(i);var o=a.getItemByPos(i);o&&0!=o.droptype&&(o.droptype=0,o.updateItem()),o&&o.datacopy&&0==o.droptype?(a.touchPos=i,a.bChoosed=!0,a.setdragitempos(o.node.position),a.item_drag.index=o.index,a.item_drag.setItemData(o.datacopy),a.item_drag.linkItem=o,a.showmergetips(o.datacopy.lv)):(a.item_drag.node.active=!1,a.autocomindexs[0]=-1,a.autocomindexs[1]=-1)},this),t.on(cc.Node.EventType.TOUCH_MOVE,function(e){var i=e.getLocation();if(i=t.convertToNodeSpaceAR(i),a.bChoosed&&i.sub(a.touchPos).mag()>15){if(null==a.item_drag.datacopy)return;a.GetGameObject("btn_delete").opacity=255,a.item_drag.node.active=!0,a.item_drag.linkItem.setItemData(null),a.setdragitempos(i);var o=a.GetGameObject("btn_delete").position;o=a.GetGameObject("btn_delete").parent.convertToWorldSpaceAR(o),e.getLocation().sub(cc.v2(o.x,o.y)).mag()<100?a.GetGameObject("btn_delete").scale=.55:a.GetGameObject("btn_delete").scale=.5}},this),t.on(cc.Node.EventType.TOUCH_END,this.docomp,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this.docomp,this),[2]})})},e.prototype.tryAutocom=function(){var t=this;if(!this.bPauseAutoCom&&!this.bInAutoCom&&l.default.getServerTime()<u.default.user.auto_com_time&&!this.bInAutoCom){this.initComposeItems();for(var e,i=function(i){if(!o.items[i]||!o.items[i].datacopy)return"continue";for(var n=i+1;n<o.items.length;++n)if(o.items[n]&&o.items[n].datacopy){if(o.bInAutoCom)return{value:void 0};if(o.items[i].datacopy.lv==o.items[n].datacopy.lv&&0==o.items[i].droptype&&0==o.items[n].droptype&&o.items[i].datacopy.lv<y.MAX_PLANT)return o.autocomindexs[0]=o.items[i].index,o.autocomindexs[1]=o.items[n].index,o.item_drag.linkItem=o.items[n],o.item_drag.index=o.items[n].index,o.item_drag.setItemData(o.items[n].datacopy),o.item_drag.node.active=!0,o.items[n].setItemData(null),o.item_drag.node.position=o.items[n].node.position,o.setdragitempos(o.items[n].node),e=o.GetGameObject("node_com").convertToWorldSpaceAR(o.items[i].node.position),e=o.GetGameObject("item_drag").parent.convertToNodeSpaceAR(e),o.bInAutoCom=!0,o.item_drag.node.stopAllActions(),o.item_drag.node.runAction(cc.sequence(cc.moveTo(.13,cc.v2(e.x,e.y)),cc.callFunc(function(){t.comani(t.items[i]),t.bInAutoCom=!1}))),{value:void 0}}},o=this,n=0;n<this.items.length;++n){var r=i(n);if("object"==typeof r)return r.value}}},e.prototype.docomp=function(t){var e=this;this.touchendtime=l.default.getServerTime(),this.hidemergetips(),this.GetGameObject("btn_delete").stopAllActions(),this.GetGameObject("btn_delete").runAction(cc.sequence(cc.delayTime(2),cc.fadeTo(1,0))),this.GetGameObject("node_com").runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){e.bPauseAutoCom=!1,e.bInAutoCom=!1}))),this.bChoosed=!1;var i=t?t.getLocation():cc.Vec2.ZERO;if(this.item_drag.node.active){if(!this.item_drag.datacopy)return;var o=this.GetGameObject("btn_delete").position;if(o=this.GetGameObject("btn_delete").parent.convertToWorldSpaceAR(o),i.sub(cc.v2(o.x,o.y)).mag()<100){this.item_drag.node.active=!1,this.autocomindexs[0]=-1,this.autocomindexs[1]=-1,this.GetGameObject("btn_delete").scale=.5;for(var n=0,r=0;r<this.items.length;++r)this.items[r].datacopy&&n++;if(n<=2)return p.default.show("\u690d\u7269\u6570\u91cf\u8fc7\u5c11\u4e0d\u80fd\u5220\u9664"),this.item_drag.linkItem.setItemData(this.item_drag.datacopy),this.item_drag.linkItem=null,void(this.item_drag.node.active=!1);if(this.item_drag.datacopy.lv>=u.default.user.GetMaxLv())return p.default.show("\u6700\u9ad8\u7b49\u7ea7\u690d\u7269\u5c31\u4e0d\u5220\u9664\u4e86\u5427\uff01"),this.item_drag.linkItem.setItemData(this.item_drag.datacopy),this.item_drag.linkItem=null,void(this.item_drag.node.active=!1);u.default.user.DropPlant(this.item_drag.datacopy.index),this.item_drag.linkItem.setItemData(null),this.item_drag.linkItem=null}i=this.GetGameObject("node_com").convertToNodeSpaceAR(i);var a=this.getItemByPos(i);if(null==a||0==u.default.user.slots[a.index]||a==this.item_drag.linkItem||a&&0!=a.droptype)return this.item_drag.linkItem&&this.item_drag.linkItem.setItemData(this.item_drag.datacopy),this.item_drag.linkItem=null,this.item_drag.node.stopAllActions(),this.item_drag.node.active=!1,this.autocomindexs[0]=-1,void(this.autocomindexs[1]=-1);if(!a.datacopy)return this.item_drag.node.active=!1,this.autocomindexs[0]=-1,this.autocomindexs[1]=-1,u.default.user.CompMove(this.item_drag.linkItem.index,a.index),a.setItemData(this.item_drag.datacopy),this.item_drag.linkItem.setItemData(null),void(this.item_drag.linkItem=null);if(a.datacopy.open==this.item_drag.datacopy.open&&a.datacopy.lv==this.item_drag.datacopy.lv&&a.datacopy.index!=this.item_drag.datacopy.index&&0==a.droptype&&a.datacopy.lv<y.MAX_PLANT)this.comani(a);else{this.item_drag.node.active=!1,this.autocomindexs[0]=-1,this.autocomindexs[1]=-1,u.default.user.CompMove(this.item_drag.linkItem.index,a.index);var s=JSON.parse(JSON.stringify(a.datacopy));a.setItemData(this.item_drag.datacopy),this.item_drag.linkItem.setItemData(s)}}else{if(!t)return;this.item_drag.linkItem=null}},e.prototype.comani=function(t){f.default.Instance().playSFX("com");var e=u.default.user.ComposePlant(t.index,this.item_drag.datacopy.index);if(this.GetGameObject("guild_1").active=!1,1==u.default.user.guideIndex&&(u.default.user.guideIndex++,u.default.save()),e){var i=u.default.user.getPlantInfo(t.index);t.setItemData(i),this.GetGameObject("item_drag").active=!1,this.item_drag.datacopy=null,this.item_drag.linkItem=null,this.autocomindexs=[-1,-1];var o=this.GetGameObject("node_com").convertToWorldSpaceAR(t.node.position);o=this.GetGameObject("item_drag").parent.convertToNodeSpaceAR(o),this.playSkAni("spine/other/effect_hecheng","effect",this.GetGameObject("item_drag").parent,o.add(cc.v3(0,20,0)),1)}},e.prototype.updateBuyButton=function(){var t=u.default.user.GetMaxLv()-3;t<1&&(t=1),this.SetText("lbl_buy_cost",l.default.formatNumber(u.default.user.BuyPrice(t))),this.SetSprite("icon_buy","texture/plants/"+(t-1))},e.prototype.tryBuyPlant=function(t,e){for(var i=null,o=0;o<12;++o)if(0!=u.default.user.slots[o]&&!this.items[o].datacopy&&this.autocomindexs[0]!=o&&this.autocomindexs[1]!=o){i=this.items[o];break}if(t||(t=u.default.user.GetMaxLv()-3)<1&&(t=1),i){if(0==e){var n=u.default.user.BuyPrice(t);if(u.default.user.BuyPrice(t)>u.default.user.coin)return void p.default.show("\u91d1\u5e01\u4e0d\u8db3");u.default.user.coin-=n}else if(1==e){var r=Math.min(5,Number(y.DB_plant[t-1][6]));if(r>u.default.user.gem)return void p.default.show("\u94bb\u77f3\u4e0d\u8db3");u.default.user.gem-=r}return e>=3&&console.log("\u82b1\u76c6\u6389\u843d"),f.default.Instance().playSFX("flower_pot_land"),this.docomp(null),i.setItemData(u.default.user.BuyPlant(i.index,t),e),this.updateBuyButton(),!0}return e<=2&&(p.default.show("\u4f4d\u7f6e\u4e0d\u591f\u5566\uff01"),this.GetGameObject("btn_delete").stopAllActions(),this.GetGameObject("btn_delete").opacity=255,this.GetGameObject("btn_delete").runAction(cc.sequence(cc.delayTime(2),cc.fadeTo(1,0)))),!1},e.prototype.mergetip=function(){if(this.touchendtime=l.default.getServerTime(),!this.bPauseAutoCom&&!this.bInAutoCom&&!this.bInAutoCom)for(var t=0;t<this.items.length;++t)if(this.items[t]&&this.items[t].datacopy)for(var e=t+1;e<this.items.length;++e)if(this.items[e]&&this.items[e].datacopy){if(this.bInAutoCom)return;if(this.items[t].datacopy.lv==this.items[e].datacopy.lv&&0==this.items[t].droptype&&0==this.items[e].droptype&&this.items[t].datacopy.lv<y.MAX_PLANT){var i=this.items[t].index,o=this.items[e].index;this.GetGameObject("guild_1").active=!0,this.GetGameObject("guild_1").zIndex=cc.macro.MAX_ZINDEX,this.GetGameObject("guild_1").stopAllActions();var n=this.GetGameObject("slots").children[i].position,r=this.GetGameObject("slots").children[o].position;return this.GetGameObject("guild_1").position=n,void this.GetGameObject("guild_1").runAction(cc.sequence(cc.moveTo(1,cc.v2(r.x,r.y)),cc.moveTo(.1,cc.v2(n.x,n.y))).repeatForever())}}},e.prototype.onBtnClicked=function(t){var e=t.target.name;switch(f.default.Instance().playSFX("click"),e){case"btn_setting":l.default.createUI("prefab/SettingUI");break;case"btn_buy":this.tryBuyPlant(null,0),this.GetGameObject("guild_0").active=!1,0==u.default.user.guideIndex&&(u.default.user.guideIndex++,u.default.save()),1==u.default.user.guideIndex&&this.mergetip();break;case"bt_fast_gen":l.default.createUI("prefab/AdLayer").then(function(t){t.getComponent(m.default).setType(m.EADLAYER.DROP_PLANT)});break;case"btn_angry":l.default.createUI("prefab/AdLayer").then(function(t){t.getComponent(m.default).setType(m.EADLAYER.DOUBLE_ATT)});break;case"btn_double_coin":l.default.createUI("prefab/AdLayer").then(function(t){t.getComponent(m.default).setType(m.EADLAYER.DOUBLE_INCOME)});break;case"bt_auto_merge":l.default.createUI("prefab/AdLayer").then(function(t){t.getComponent(m.default).setType(m.EADLAYER.AUTO_COM)});break;case"btn_shop":T.default.show();break;case"btn_delete":255==this.GetGameObject("btn_delete").opacity&&p.default.show("\u62d6\u52a8\u5230\u8fd9\u91cc\u5356\u51fa")}},e._instance=null,r([S(cc.Prefab)],e.prototype,"enemy_pre",void 0),r([S(cc.Prefab)],e.prototype,"pre_soldier",void 0),i=r([G],e)}(c.default);i.default=w,cc._RF.pop()},{"../../resources/prefab/AdLayer":void 0,"../../resources/prefab/Enemy":void 0,"../../resources/prefab/LoseUI":void 0,"../../resources/prefab/OfflineAwardUI":void 0,"../../resources/prefab/ShopLayer":void 0,"../../resources/prefab/VictoryUI":void 0,"../framwork/BaseUI":"BaseUI","../framwork/MsgHints":"MsgHints","../manager/Data":"Data","../utils/AudioMgr":"AudioMgr","../utils/Utils":"Utils","./DB":"DB","./SlotItem":"SlotItem","./SoldierItem":"SoldierItem"}],ListItem:[function(t,e,i){"use strict";cc._RF.push(e,"66c9a84a69BcLUb4nTwbgy6","ListItem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a,s=cc._decorator,c=s.ccclass,l=s.property,u=s.disallowMultiple,h=s.menu,d=s.executionOrder;(function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"})(a||(a={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.title=null,e.selectedMode=a.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e._selected=!1,e._eventReg=!1,e}return n(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case a.TOGGLE:this.selectedFlag.active=t;break;case a.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){if(this._btnCom=this.node.getComponent(cc.Button),this._btnCom||(this.selectedMode,a.NONE),this.selectedMode==a.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype._registerEvent=function(){if(this._btnCom&&this.list.selectedMode>0&&!this._eventReg){var t=new cc.Component.EventHandler;t.target=this.node,t.component="ListItem",t.handler="onClickThis",this._btnCom.clickEvents.unshift(t),this._eventReg=!0}},e.prototype.showAni=function(t,e,i){var o,n=this;switch(t){case 0:o=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,2*this.node.height)];break;case 1:o=[cc.scaleTo(.2,.7),cc.moveBy(.3,2*this.node.width,0)];break;case 2:o=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,-2*this.node.height)];break;case 3:o=[cc.scaleTo(.2,.7),cc.moveBy(.3,-2*this.node.width,0)];break;default:o=[cc.scaleTo(.3,.1)]}(e||i)&&o.push(cc.callFunc(function(){if(i){n.list._delSingleItem(n.node);for(var t=n.list.displayData.length-1;t>=0;t--)if(n.list.displayData[t].id==n.listId){n.list.displayData.splice(t,1);break}}e()})),this.node.runAction(cc.sequence(o))},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},r([l({type:cc.Sprite,tooltip:!1})],e.prototype,"icon",void 0),r([l({type:cc.Node,tooltip:!1})],e.prototype,"title",void 0),r([l({type:cc.Enum(a),tooltip:!1})],e.prototype,"selectedMode",void 0),r([l({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>a.NONE}})],e.prototype,"selectedFlag",void 0),r([l({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==a.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),r([c,u(),h("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),d(-5001)],e)}(cc.Component);i.default=p,cc._RF.pop()},{}],List:[function(t,e,i){"use strict";cc._RF.push(e,"747f8Ttu9JGQrJfzFDk8XpT","List");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a,s,c,l=cc._decorator,u=l.ccclass,h=l.property,d=l.disallowMultiple,p=l.menu,f=l.executionOrder,m=t("./ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(a||(a={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(s||(s={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(c||(c={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=a.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=s.NORMAL,e.pageDistance=.3,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.lackCenter=!1,e._updateRate=2,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=c.NONE,e.selectedEvent=null,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return n(e,t),Object.defineProperty(e.prototype,"slideModel",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling(null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,i=this;if(i.selectedMode!=c.SINGLE||t!=i._selectedId)switch(i.selectedMode){case c.SINGLE:if(t==i._selectedId)return;if(!(e=i.getItemByListId(t))&&t>=0)return;var o=void 0;if(i._selectedId>=0?i._lastSelectedId=i._selectedId:i._lastSelectedId=null,i._selectedId=t,e&&((o=e.getComponent(m.default)).selected=!0),i._lastSelectedId>=0){var n=i.getItemByListId(i._lastSelectedId);n&&(n.getComponent(m.default).selected=!1)}i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t,i._lastSelectedId);break;case c.MULT:if(!(e=i.getItemByListId(t)))return;o=e.getComponent(m.default),i._selectedId>=0&&(i._lastSelectedId=i._selectedId),i._selectedId=t;var r=!o.selected;o.selected=r;var a=i.multSelected.indexOf(t);r&&a<0?i.multSelected.push(t):!r&&a>=0&&i.multSelected.splice(a,1),i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t,i._lastSelectedId,r)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._numItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e._onScrolling(null);else{var i=e.content.getComponent(cc.Layout);if(i&&(i.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var o=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,n=0;n<o;n++)e._createOrUpdateItem2(n);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(n=0;n<t;n++)e._createOrUpdateItem2(n);e.actualNumItems=t}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.start=function(){this._init()},e.prototype.onEnable=function(){this._registerEvent(),this._init()},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on("touch-up",t._onScrollTouchUp,t),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0)},e.prototype._unregisterEvent=function(){var t=this;t.node.off("touch-up",t._onScrollTouchUp,t),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t._scrollView)if(t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(t.templateType==a.PREFAB?t.tmpPrefab.data:t.tmpNode),t._slideMode!=s.ADHERING&&t._slideMode!=s.PAGE||(t._scrollView.inertia=!1),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.removeAllChildren(),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!");else cc.error(t.node.name+" no assembly cc.ScrollView!")},e.prototype.setTemplateItem=function(t){if(t){var e=this;switch(e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(e._itemTmp.width,e._itemTmp.height),e.selectedMode==c.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var i=e.content.width-e._leftGap-e._rightGap;for(e._colLineNum=1;;){if(i-(e._colLineNum*e._itemSize.width+(e._colLineNum-1)*e._columnGap)<0){e._colLineNum--;break}e._colLineNum++}e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var o=e.content.height-e._topGap-e._bottomGap;for(e._colLineNum=1;;){if(o-(e._colLineNum*e._itemSize.height+(e._colLineNum-1)*e._lineGap)<0){e._colLineNum--;break}e._colLineNum++}e._sizeType=!1}}}},e.prototype.checkInited=function(t){var e=t||!0;return!!this._inited||(e&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e.customSize){var i=e._getFixedSize(null);t=e._leftGap+i.val+e._itemSize.width*(e._numItems-i.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:e.customSize?(i=e._getFixedSize(null),t=e._topGap+i.val+e._itemSize.height*(e._numItems-i.count)+e._lineGap*(e._numItems-1)+e._bottomGap):t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var o=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*o+e._lineGap*(o-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var n=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*n+e._columnGap*(n-1)+e._rightGap}}var r,a=e.content.getComponent(cc.Layout);a&&(a.enabled=!1),e._allItemSize=t,e._sizeType?((r=t<e.node.height?e.node.height-.1:t)<0&&(r=0),e._lackSize=e.lackCenter?r:null,e._allItemSizeNoBorder=e._allItemSize-e._topGap-e._bottomGap,e.content.height=r):((r=t<e.node.width?e.node.width-.1:t)<0&&(r=0),e._lackSize=e.lackCenter?r:null,e._allItemSizeNoBorder=e._allItemSize-e._leftGap-e._rightGap,e.content.width=r)},e.prototype._onScrolling=function(t){if(null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning&&(this._calcViewPos(),this._virtual)){this.displayData=[];var e=void 0,i=0,o=this._numItems-1;if(this.customSize)for(var n=!1;i<=o&&!n;i++)switch(e=this._calcItemPos(i),this._align){case cc.Layout.Type.HORIZONTAL:e.right>=this.viewLeft&&e.left<=this.viewRight?this.displayData.push(e):0!=i&&this.displayData.length>0&&(n=!0);break;case cc.Layout.Type.VERTICAL:e.bottom<=this.viewTop&&e.top>=this.viewBottom?this.displayData.push(e):0!=i&&this.displayData.length>0&&(n=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:e.bottom<=this.viewTop&&e.top>=this.viewBottom?this.displayData.push(e):0!=i&&this.displayData.length>0&&(n=!0);break;case cc.Layout.AxisDirection.VERTICAL:e.right>=this.viewLeft&&e.left<=this.viewRight?this.displayData.push(e):0!=i&&this.displayData.length>0&&(n=!0)}}else{var r=this._itemSize.width+this._columnGap,a=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:i=(this.viewLeft+this._leftGap)/r,o=(this.viewRight+this._rightGap)/r;break;case 2:i=(-this.viewRight-this._rightGap)/r,o=(-this.viewLeft-this._leftGap)/r;break;case 3:i=(-this.viewTop-this._topGap)/a,o=(-this.viewBottom-this._bottomGap)/a;break;case 4:i=(this.viewBottom+this._bottomGap)/a,o=(this.viewTop+this._topGap)/a}for(i=Math.floor(i)*this._colLineNum,o=Math.ceil(o)*this._colLineNum,i<0&&(i=0),--o>=this._numItems&&(o=this._numItems-1);i<=o;i++)this.displayData.push(this._calcItemPos(i))}if(this.displayData.length<=0||!this._numItems)return void this._delRedundantItem();this.firstListId=this.displayData[0].id,this.actualNumItems=this.displayData.length;var s=this._lastDisplayData.length;if(this._forceUpdate||this.actualNumItems!=s||this.firstListId!=this._lastDisplayData[0]||this.displayData[this.actualNumItems-1].id!=this._lastDisplayData[s-1])if(this._lastDisplayData=[],this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._delRedundantItem(),this._updateCounter=0,this._updateDone=!0);else{for(var c=0;c<this.actualNumItems;c++)this._createOrUpdateItem(this.displayData[c]);this._delRedundantItem(),this._forceUpdate=!1}this._calcNearestItem()}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,i,o,n,r,a,s,c;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this.customSize){var l=this._getFixedSize(t);r=this._leftGap+(this._itemSize.width+this._columnGap)*(t-l.count)+(l.val+this._columnGap*l.count),e=(u=this.customSize[t])>0?u:this._itemSize.width}else r=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;return a=r+e,this.lackCenter&&this._lackSize>=0&&(r+=h=this.content.width/2-this._allItemSizeNoBorder/2,a+=h),{id:t,left:r,right:a,x:r+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:return this.customSize?(l=this._getFixedSize(t),a=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-l.count)-(l.val+this._columnGap*l.count),e=(u=this.customSize[t])>0?u:this._itemSize.width):(a=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width),r=a-e,this.lackCenter&&this._lackSize>=0&&(r-=h=this.content.width/2-this._allItemSizeNoBorder/2,a-=h),{id:t,right:a,left:r,x:r+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:return this.customSize?(l=this._getFixedSize(t),o=-this._topGap-(this._itemSize.height+this._lineGap)*(t-l.count)-(l.val+this._lineGap*l.count),i=(u=this.customSize[t])>0?u:this._itemSize.height):(o=-this._topGap-(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height),n=o-i,this.lackCenter&&this._lackSize>=0&&(o-=h=this.content.height/2-this._allItemSizeNoBorder/2,n-=h),{id:t,top:o,bottom:n,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*i};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:var u,h;if(this.customSize)l=this._getFixedSize(t),n=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-l.count)+(l.val+this._lineGap*l.count),i=(u=this.customSize[t])>0?u:this._itemSize.height;else n=this._bottomGap+(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height;return o=n+i,this.lackCenter&&this._lackSize>=0&&(o+=h=this.content.height/2-this._allItemSizeNoBorder/2,n+=h),{id:t,top:o,bottom:n,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*i}}case cc.Layout.Type.GRID:var d=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c=(n=(o=-this._topGap-(this._itemSize.height+this._lineGap)*d)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:o=(n=this._bottomGap+(this._itemSize.height+this._lineGap)*d)+this._itemSize.height,c=n+this._itemTmp.anchorY*this._itemSize.height}switch(s=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:s+=this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s+=(1-this._itemTmp.anchorX)*this._itemSize.width,s-=(1-this.content.anchorX)*this.content.width,s*=-1}return{id:t,top:o,bottom:n,x:s,y:c};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:a=(r=this._leftGap+(this._itemSize.width+this._columnGap)*d)+this._itemSize.width,s=r+this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s=(r=(a=-this._rightGap-(this._itemSize.width+this._columnGap)*d)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,s+=(1-this.content.anchorX)*this.content.width}switch(c=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c-=(1-this._itemTmp.anchorY)*this._itemSize.height,c+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:c-=this._itemTmp.anchorY*this._itemSize.height,c+=this.content.anchorY*this.content.height,c*=-1}return{id:t,left:r,right:a,x:s,y:c}}}},e.prototype._getFixedSize=function(t){if(!this.customSize)return null;null==t&&(t=this._numItems);var e=0,i=0;for(var o in this.customSize)parseInt(o)<t&&(e+=this.customSize[o],i++);return{val:e,count:i}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&e.runAction(cc.sequence(cc.scaleTo(.1,1.06),cc.scaleTo(.1,1)))}t._onScrolling(null),t._slideMode!=s.ADHERING||t.adhering?t._slideMode==s.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onScrollTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==s.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==s.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere())},e.prototype._pageAdhere=function(){var t=this;if(!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,i=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>i)switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.actualNumItems?this.actualNumItems:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++){var i=this.displayData[e];i&&this._createOrUpdateItem(i)}this._updateCounter>=this.actualNumItems-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._scrollView.isScrolling()||(this._doneAfterUpdate=!1)):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem()):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(t=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++)this._createOrUpdateItem2(e);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem()},e.prototype._createOrUpdateItem=function(t){var e,i=this.getItemByListId(t.id);i?this._forceUpdate&&this.renderEvent&&(i.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(i),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t.id)):((i=this._pool.size()?this._pool.get():cc.instantiate(this._itemTmp)).setPosition(cc.v2(t.x,t.y)),this._resetItemSize(i),this.content.addChild(i),i.setSiblingIndex(this.content.childrenCount-1),(e=i.getComponent(m.default)).listId=t.id,e.list=this,e._registerEvent(),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t.id)),this._resetItemSize(i),this._updateListItem(e),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},e.prototype._createOrUpdateItem2=function(t){var e,i=this.content.children[t];i?this._forceUpdate&&this.renderEvent&&((e=i.getComponent(m.default)).listId=t,this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t)):(i=cc.instantiate(this._itemTmp),this.content.addChild(i),(e=i.getComponent(m.default)).listId=t,e.list=this,e._registerEvent(),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>c.NONE)switch(this.selectedMode){case c.SINGLE:t.selected=this.selectedId==t.listId;break;case c.MULT:t.selected=this.multSelected.indexOf(t.listId)>=0}},e.prototype._resetItemSize=function(t){var e=t.getComponent(m.default);if(this.customSize&&this.customSize[e.listId]){var i=this.customSize[e.listId];this._align==cc.Layout.Type.HORIZONTAL?t.width=i:this._align==cc.Layout.Type.VERTICAL&&(t.height=i)}else t.setContentSize(this._itemSize)},e.prototype.setMultSelected=function(t,e){var i=this;if(Array.isArray(t)||(t=[t]),null==e)i.multSelected=null,i.multSelected=t;else{var o=void 0,n=void 0;if(e)for(var r=t.length-1;r>=0;r--)o=t[r],(n=i.multSelected.indexOf(o))<0&&i.multSelected.push(o);else for(r=t.length-1;r>=0;r--)o=t[r],(n=i.multSelected.indexOf(o))>=0&&i.multSelected.splice(n,1)}i._forceUpdate=!0,i._onScrolling(null)},e.prototype.updateAppointed=function(t){Array.isArray(t)||(t=[t]);for(var e=t.length,i=0;i<e;i++){var o=t[i],n=this.getItemByListId(o);n&&cc.Component.EventHandler.emitEvents([this.renderEvent],n,o)}},e.prototype.getItemByListId=function(t){for(var e=this.content.childrenCount-1;e>=0;e--)if(this.content.children[e].getComponent(m.default).listId==t)return this.content.children[e];return null},e.prototype._getOutsideItem=function(){for(var t,e,i=[],o=this.content.childrenCount-1;o>=0;o--){if(t=this.content.children[o],e=!0)for(var n=this.actualNumItems-1;n>=0;n--)if(this.displayData[n]){var r=this.displayData[n].id;if(t.getComponent(m.default).listId==r){e=!1;break}}e&&i.push(t)}return i},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--)this._pool.put(t[e]);else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,i){var o,n=this,r=n.getItemByListId(t);if(!n._aniDelRuning&&n._virtual)if(r){o=r.getComponent(m.default),n._aniDelRuning=!0;var a=n.displayData[n.displayData.length-1].id,s=o.selected;o.showAni(i,function(){var i,o,l;if(a<n._numItems-2&&(i=a+1),null!=i){var u=n._calcItemPos(i);n.displayData.push(u),n._virtual?n._createOrUpdateItem(u):n._createOrUpdateItem2(i)}else n._numItems--;if(n.selectedMode==c.SINGLE)s?n._selectedId=-1:n._selectedId-1>=0&&n._selectedId--;else if(n.selectedMode==c.MULT&&n.multSelected.length){var h=n.multSelected.indexOf(t);h>=0&&n.multSelected.splice(h,1);for(var d=n.multSelected.length-1;d>=0;d--)(m=n.multSelected[d])>=t&&n.multSelected[d]--}if(n.customSize){n.customSize[t]&&delete n.customSize[t];var p={},f=void 0;for(var m in n.customSize){f=n.customSize[m];var _=parseInt(m);p[_-(_>=t?1:0)]=f}n.customSize=p}for(d=null!=i?i:a;d>=t+1;d--)if(r=n.getItemByListId(d)){var y=n._calcItemPos(d-1);o=[cc.moveTo(.2333,cc.v2(y.x,y.y))],d<=t+1&&(l=!0,o.push(cc.callFunc(function(){n._aniDelRuning=!1,e(t)}))),o.length>1?r.runAction(cc.sequence(o)):r.runAction(o[0])}l||(n._aniDelRuning=!1,e(t))},!0)}else e(t)},e.prototype.scrollTo=function(t,e,i,o){void 0===e&&(e=.5),void 0===i&&(i=null),void 0===o&&(o=!1);var n=this;if(n.checkInited(!1)){n._scrollView.stopAutoScroll(),null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=n._numItems&&(t=n._numItems-1);var r,a,s=n._calcItemPos(t);switch(n._alignCalcType){case 1:r=s.left,r-=null!=i?n.node.width*i:n._leftGap,s=cc.v2(r,0);break;case 2:r=s.right-n.node.width,r+=null!=i?n.node.width*i:n._rightGap,s=cc.v2(r+n.content.width,0);break;case 3:a=s.top,a+=null!=i?n.node.height*i:n._topGap,s=cc.v2(0,-a);break;case 4:a=s.bottom+n.node.height,a-=null!=i?n.node.height*i:n._bottomGap,s=cc.v2(0,-a+n.content.height)}var c=n.content.getPosition();c=Math.abs(n._sizeType?c.y:c.x);var l=n._sizeType?s.y:s.x,u=Math.abs((null!=n._scrollPos?n._scrollPos:c)-l)>.5;n._scrollView.stopAutoScroll(),u&&(n._scrollView.scrollToOffset(s,e),n.scheduleOnce(function(){if(n._adheringBarrier||(n.adhering=n._adheringBarrier=!1),o){var e=n.getItemByListId(t);e&&e.runAction(cc.sequence(cc.scaleTo(.1,1.05),cc.scaleTo(.1,1)))}},e+.1),e<=0&&n._onScrolling(null))}},e.prototype._calcNearestItem=function(){var t,e;this.nearestListId=null,this._virtual&&this._calcViewPos();for(var i=!1,o=0;o<this.content.childrenCount&&!i;o+=this._colLineNum)switch(t=this._virtual?this.displayData[o]:this._calcExistItemPos(o),e=this._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,this._alignCalcType){case 1:t.right>=this.viewLeft&&(this.nearestListId=t.id,this.viewLeft>e&&(this.nearestListId+=this._colLineNum),i=!0);break;case 2:t.left<=this.viewRight&&(this.nearestListId=t.id,this.viewRight<e&&(this.nearestListId+=this._colLineNum),i=!0);break;case 3:t.bottom<=this.viewTop&&(this.nearestListId=t.id,this.viewTop<e&&(this.nearestListId+=this._colLineNum),i=!0);break;case 4:t.top>=this.viewBottom&&(this.nearestListId=t.id,this.viewBottom>e&&(this.nearestListId+=this._colLineNum),i=!0)}if((t=this._virtual?this.displayData[this.actualNumItems-1]:this._calcExistItemPos(this._numItems-1))&&t.id==this._numItems-1)switch(e=this._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,this._alignCalcType){case 1:this.viewRight>e&&(this.nearestListId=t.id);break;case 2:this.viewLeft<e&&(this.nearestListId=t.id);break;case 3:this.viewBottom<e&&(this.nearestListId=t.id);break;case 4:this.viewTop>e&&(this.nearestListId=t.id)}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var i={id:t,x:e.x,y:e.y};return this._sizeType?(i.top=e.y+e.height*(1-e.anchorY),i.bottom=e.y-e.height*e.anchorY):(i.left=e.x-e.width*e.anchorX,i.right=e.x+e.width*(1-e.anchorX)),i},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var i=this;if(i._slideMode!=s.PAGE)return cc.error("This function is not allowed to be called, Must SlideMode = PAGE!");t<0||t>=i._numItems||i.curPageNum!=t&&(i.curPageNum=t,i.pageChangeEvent&&cc.Component.EventHandler.emitEvents([i.pageChangeEvent],t),i.scrollTo(t,e))},e.prototype.calcCustomSize=function(t){var e=this;if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e.customSize={};var i=cc.instantiate(e._itemTmp);e.content.addChild(i);for(var o=0;o<t;o++)cc.Component.EventHandler.emitEvents([e.renderEvent],i,o),i.height==e._itemSize.height&&i.width==e._itemSize.width||(e.customSize[o]=e._sizeType?i.height:i.width);return Object.keys(e.customSize).length||(e.customSize=null),i.removeFromParent(),i.destroy&&i.destroy(),e.customSize},r([h({type:cc.Enum(a),tooltip:!1})],e.prototype,"templateType",void 0),r([h({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==a.NODE}})],e.prototype,"tmpNode",void 0),r([h({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==a.PREFAB}})],e.prototype,"tmpPrefab",void 0),r([h()],e.prototype,"_slideMode",void 0),r([h({type:cc.Enum(s),tooltip:!1})],e.prototype,"slideModel",null),r([h({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==s.PAGE}})],e.prototype,"pageDistance",void 0),r([h({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==s.PAGE}})],e.prototype,"pageChangeEvent",void 0),r([h()],e.prototype,"_virtual",void 0),r([h({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),r([h({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),r([h({type:cc.Integer})],e.prototype,"_updateRate",void 0),r([h({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),r([h({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),r([h({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),r([h({type:cc.Enum(c),tooltip:!1})],e.prototype,"selectedMode",void 0),r([h({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>c.NONE}})],e.prototype,"selectedEvent",void 0),r([h({serializable:!1})],e.prototype,"_numItems",void 0),r([u,d(),p("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),f(-5e3)],e)}(cc.Component);i.default=_,cc._RF.pop()},{"./ListItem":"ListItem"}],LongTouchComponent:[function(t,e,i){"use strict";cc._RF.push(e,"e00b9OAUdVJhbS0BUI7M5px","LongTouchComponent");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchInterval=.02,e.enableMultiTouching=!1,e.longTouchEvents=[],e._touchCounter=0,e._isTouching=!1,e}return n(e,t),e.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.unschedule(this._touchCounterCallback)},e.prototype.clear=function(){this._isTouching=!1,this.unschedule(this._touchCounterCallback)},e.prototype._onTouchStart=function(t){var e=this;if(!this.enableMultiTouching){if(this._isTouching)return;this.node.getBoundingBoxToWorld().contains(t.getLocation())?this._isTouching=!0:this._isTouching=!1,this._isTouching&&(this.publishOneTouch(),this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){e._isTouching&&(e.unschedule(e._touchCounterCallback),e.schedule(e._touchCounterCallback,e.touchInterval))}))))}},e.prototype._onTouchEnd=function(){this._isTouching=!1,this._touchCounter=0,this.unschedule(this._touchCounterCallback)},e.prototype._onTouchCancel=function(){this._isTouching=!1,this._touchCounter=0,this.unschedule(this._touchCounterCallback)},e.prototype._touchCounterCallback=function(){this._isTouching?this.publishOneTouch():this.unschedule(this._touchCounterCallback)},e.prototype.publishOneTouch=function(){var t=this;this._isTouching&&(this.node.runAction(cc.sequence(cc.scaleTo(this.touchInterval/2,1.2),cc.scaleTo(this.touchInterval/2,1))),this._touchCounter++,this.longTouchEvents.forEach(function(e){e.emit([t.node])}))},r([c({tooltip:"\u89e6\u6478\u56de\u8c03\u95f4\u9694\uff08\u79d2\uff09\u3002\u5047\u5982\u4e3a0.1\uff0c\u90a3\u4e481\u79d2\u5185\u4f1a\u56de\u8c0310\u6b21 ${longTouchEvents} \u4e8b\u4ef6\u6570\u7ec4"})],e.prototype,"touchInterval",void 0),r([c({readonly:!0,tooltip:"\u662f\u5426\u652f\u6301\u591a\u70b9\u89e6\u63a7\uff08\u5f53\u524d\u8fd8\u4e0d\u652f\u6301\uff09"})],e.prototype,"enableMultiTouching",void 0),r([c({type:[cc.Component.EventHandler],tooltip:"\u56de\u8c03\u4e8b\u4ef6\u6570\u7ec4\uff0c\u6bcf\u95f4\u9694 ${toucheInterval}s \u56de\u8c03\u4e00\u6b21"})],e.prototype,"longTouchEvents",void 0),r([s],e)}(cc.Component);i.default=l,cc._RF.pop()},{}],MsgHints:[function(t,e,i){"use strict";cc._RF.push(e,"922a144cLRCbrDv5hv5JyP8","MsgHints");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../manager/PoolMgr"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var i;return n(e,t),i=e,e.show=function(t){if(""!=t)if(null!=i._prefab){if(0!=a.default.Instance().pools.msg_hints.size()){var e=a.default.Instance().get("msg_hints");e.scaleY=0,e.parent=cc.find("Canvas"),e.zIndex=999999999,e.getChildByName("label").getComponent(cc.Label).string=t,e.getComponent(cc.Animation).play("msghints",0),e.getComponent(cc.Animation).on("finished",function(){a.default.Instance().put("msg_hints",e)})}}else cc.loader.loadRes("prefab/common/msg_hints",function(e,o){e||(i._prefab=o,a.default.Instance().initPool("msg_hints",i._prefab,20),i.show(t))})},e._prefab=null,i=r([c],e)}(cc.Component));i.default=l,cc._RF.pop()},{"../manager/PoolMgr":"PoolMgr"}],NumberRoll:[function(t,e,i){"use strict";cc._RF.push(e,"7afd2vdphtCjKWi+cfBvmoW","NumberRoll");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../framwork/BaseUI"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._cur=0,e._target=0,e._offset=0,e}return n(e,t),e.prototype.start=function(){this.label=this.node.getComponent(cc.Label)},Object.defineProperty(e.prototype,"vaule",{set:function(t){this._target=t,this._offset=Math.floor((this._target-this._cur)/Math.min(30,Math.abs(this._target-this._cur)))},enumerable:!1,configurable:!0}),e.prototype.update=function(t){1/t<cc.game.getFrameRate()/2?this.label.string=this._target+"":(this._cur!=this._target&&(this._cur+=this._offset,this._offset>0&&this._cur>this._target&&(this._cur=this._target),this._offset<0&&this._cur<this._target&&(this._cur=this._target)),this.label.string=this._cur+"")},r([c],e)}(a.default));i.default=l,cc._RF.pop()},{"../framwork/BaseUI":"BaseUI"}],PoolMgr:[function(t,e,i){"use strict";cc._RF.push(e,"96c22QZQoJEzrsdfStlsM1E","PoolMgr");var o=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,a=(n.property,function(){function t(){this.pools={},this.prefabs={},this.pre_bullets=[]}var e;return e=t,t.Instance=function(){return null==e._instance&&(e._instance=new e),e._instance},t.prototype.loadPrefabs=function(){var t=this;cc.loader.loadRes("prefab/Coin",cc.Prefab,function(e,i){e?console.error(e):t.initPool("Coin",i,11)}),cc.loader.loadRes("prefab/Gem",cc.Prefab,function(e,i){e?console.error(e):t.initPool("Gem",i,11)})},t.prototype.initPool=function(t,e,i){this.prefabs[t]=e,this.pools[t]=new cc.NodePool;for(var o=0;o<i;++o)this.pools[t].put(cc.instantiate(e))},t.prototype.get=function(t){if(null==this.pools[t])return cc.error("\u6ca1\u6709"+t),null;if(this.pools[t].size()>0){var e=this.pools[t].get(),i=e.getChildByName("spine");return i&&(i.getComponent(sp.Skeleton).paused=!1),e}return cc.instantiate(this.prefabs[t])},t.prototype.put=function(t,e){this.pools[t].put(e)},t._instance=null,e=o([r],t)}());i.default=a,cc._RF.pop()},{}],Shake:[function(t,e,i){"use strict";cc._RF.push(e,"776856yN0hDUJ9tpRE0AmLJ","Shake");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.Shake=void 0;var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._initial_x=0,e._initial_y=0,e._strength_x=0,e._strength_y=0,e}var i;return n(e,t),i=e,e.create=function(t,e,o){var n=new i;return n.initWithDuration(t,e,o),n},e.prototype.initWithDuration=function(t,e,i){return cc.ActionInterval.prototype.initWithDuration.apply(this,arguments),this._strength_x=e,this._strength_y=i,!0},e.prototype.fgRangeRand=function(t,e){return Math.random()*(e-t)+t},e.prototype.update=function(){var t=this.fgRangeRand(-this._strength_x,this._strength_x),e=this.fgRangeRand(-this._strength_y,this._strength_y);this.getTarget().setPosition(t+this._initial_x,e+this._initial_y)},e.prototype.startWithTarget=function(t){cc.ActionInterval.prototype.startWithTarget.apply(this,arguments),this._initial_x=t.x,this._initial_y=t.y},e.prototype.stop=function(){this.getTarget().setPosition(new cc.Vec2(this._initial_x,this._initial_y)),cc.ActionInterval.prototype.stop.apply(this)},i=r([s],e)}(cc.ActionInterval));i.Shake=c,cc._RF.pop()},{}],Singleton:[function(t,e,i){"use strict";cc._RF.push(e,"b3524d7zH9PiqxWDRneLvf8","Singleton"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.Instance=function(){return this.instance||(this.instance=new this),this.instance},t}();i.default=o,cc._RF.pop()},{}],SlotItem:[function(t,e,i){"use strict";cc._RF.push(e,"8cf323gxb5C04zxaDSUVHAv","SlotItem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../framwork/BaseUI"),s=t("../manager/Data"),c=t("./DB"),l=t("../utils/Utils"),u=t("../framwork/MsgHints"),h=t("./GameConst"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.index=0,e}var i;return n(e,t),i=e,e.getCurOpen=function(){for(var t=-1,e=1;e<12;++e)if(0==s.default.user.slots[e]){t=e;break}return t},e.prototype.onBtnClicked=function(){var t=i.getCurOpen();if(-1!=t)if(this.index-1>t)u.default.show("\u9700\u8981\u5148\u89e3\u9501"+(t+1));else{var e=c.DB_slot[t].type;if(0==e){if(s.default.user.coin<c.DB_slot[t].price)return void u.default.show("\u91d1\u5e01\u4e0d\u8db3")}else if(s.default.user.gem<c.DB_slot[t].price)return void u.default.show("\u94bb\u77f3\u4e0d\u8db3");s.default.user.slots[t]=1,0==e?s.default.user.coin-=c.DB_slot[t].price:s.default.user.gem-=c.DB_slot[t].price,console.log("\u89e3\u9501\u571f\u5730",t),s.default.save(),this.dispatch(h.default.OPEN_SLOT,t),this.setIndex(this.index)}},e.prototype.setIndex=function(t){this.index=t,this.SetText("lbl_index",t+"");var e=i.getCurOpen();this.node.getComponent(cc.Button).interactable=this.index-1>=e&&-1!=e;var o=s.default.user.slots[t-1];this.GetGameObject("lock").active=0==o,this.GetGameObject("lbl_index").active=0==o,this.GetGameObject("node_cost").active=0==o,this.GetGameObject("2btcoin").active=0==c.DB_slot[t-1].type,this.GetGameObject("2btdiamond").active=1==c.DB_slot[t-1].type,this.SetText("lbl_open_cost",l.default.formatNumber(c.DB_slot[t-1].price))},i=r([p],e)}(a.default));i.default=f,cc._RF.pop()},{"../framwork/BaseUI":"BaseUI","../framwork/MsgHints":"MsgHints","../manager/Data":"Data","../utils/Utils":"Utils","./DB":"DB","./GameConst":"GameConst"}],SoldierItem:[function(t,e,i){"use strict";cc._RF.push(e,"58176B7xzJGVr/d2mUCbUBE","SoldierItem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var i,o,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../utils/Utils"),l=t("../framwork/BaseUI"),u=t("./DB"),h=t("./HallScene"),d=t("../../resources/prefab/Bullet"),p=t("../manager/Data"),f=cc._decorator,m=f.ccclass,_=(f.executeInEditMode,f.property),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bullet_pre=null,e.index=-1,e.linkItem=null,e.datacopy=null,e.bDrag=!1,e.droptype=0,e.droptype0endtime=0,e.curplayani="",e.cd=0,e.lastfire=0,e}return n(e,t),e.prototype.setItemData=function(t,e){void 0===e&&(e=-1),-1!=e&&(this.droptype=e),0!=this.droptype&&this.droptype0endtime<c.default.getServerTime()&&(this.droptype0endtime=c.default.getServerTime()+1e4),this.datacopy&&t&&this.datacopy.index==t.index&&this.datacopy.lv==t.lv&&this.datacopy.open==t.open||(this.datacopy=t?JSON.parse(JSON.stringify(t)):null,this.datacopy&&(this.datacopy.index=this.index),this.updateItem())},e.prototype.updateItem=function(){return a(this,void 0,void 0,function(){var t,e,i,o,n=this;return s(this,function(r){switch(r.label){case 0:return this.GetGameObject("level_1").active=null!=this.datacopy,this.GetGameObject("flower1").active=null!=this.datacopy,this.datacopy?(this.GetGameObject("lbl_lv").getComponent(cc.Label).string="lv."+this.datacopy.lv,0!=this.droptype?[3,3]:(this.GetGameObject("lbl_lv").active=!0,t=u.DB_plant[Math.min(this.datacopy.lv-1,u.MAX_PLANT-1)],this.cd=Number(t[1]),this.curplayani==this.datacopy.lv+"_idleL"?[3,2]:(this.curplayani=this.datacopy.lv+"_idleL",e=this.GetSkeleton("flower1"),[4,c.default.loadRes("spine/flower"+Math.min(this.datacopy.lv,u.MAX_PLANT),sp.SkeletonData)]))):[3,8];case 1:e.skeletonData=r.sent(),this.GetSkeleton("flower1").setAnimation(0,"idleL",!0),r.label=2;case 2:return[3,8];case 3:return this.GetGameObject("lbl_lv").active=!1,4!=this.droptype?[3,6]:"pot1_idle"==this.curplayani?[3,5]:(this.curplayani="pot1_idle",this.node.opacity=0,i=this.GetSkeleton("flower1"),[4,c.default.loadRes("spine/pot1",sp.SkeletonData)]);case 4:i.skeletonData=r.sent(),this.GetSkeleton("flower1").clearTracks(),this.GetSkeleton("flower1").setAnimation(0,"fall",!1),this.node.opacity=255,this.node.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){n.GetSkeleton("flower1").setAnimation(1,"idle",!0)}))),console.log("===2=",this.datacopy.lv),r.label=5;case 5:return[3,8];case 6:return"pot3_idle"==this.curplayani?[3,8]:(this.curplayani="pot3_idle",this.node.opacity=0,o=this.GetSkeleton("flower1"),[4,c.default.loadRes("spine/pot3",sp.SkeletonData)]);case 7:o.skeletonData=r.sent(),this.GetSkeleton("flower1").clearTracks(),this.GetSkeleton("flower1").setAnimation(0,"fall",!1),this.node.opacity=255,this.node.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){n.GetSkeleton("flower1").setAnimation(1,"idle",!0)}))),console.log("===1",this.datacopy.lv),r.label=8;case 8:return[2]}})})},e.prototype.getTarget=function(){for(var t=h.default.Instance.enemylist,e=null,i=400,o=0;o<t.length;++o)if(!(t[o].x<-cc.winSize.width/2)){var n=t[o].position.sub(this.node.position).mag();n<i&&(e=t[o],i=n)}return e},e.prototype.update=function(t){var e=this;if(this.datacopy&&0==this.droptype&&p.default.user.double_att_time>c.default.getServerTime()?(this.GetSkeleton("flower1").timeScale=1.5,this.GetGameObject("kb").active=!0):(this.GetSkeleton("flower1").timeScale=1,this.GetGameObject("kb").active=!1),0!=this.droptype&&c.default.getServerTime()>this.droptype0endtime&&(this.droptype=0,this.updateItem()),!this.bDrag&&this.datacopy&&0==this.droptype&&(this.lastfire+=t,this.lastfire>=this.cd/(p.default.user.double_att_time>c.default.getServerTime()?2:1))){this.lastfire=0;var i=this.getTarget();i&&(this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){if(!e.bDrag&&e.datacopy){var t=cc.instantiate(e.bullet_pre);t.position=e.node.position.add(i.x>e.node.x?cc.v3(15,35,0):cc.v3(-15,35,0)),t.parent=h.default.Instance.GetGameObject("node_bullet"),t.getComponent(d.default).setInfo(i,e.datacopy.lv)}}))),i.x>this.node.x?(this.GetSkeleton("flower1").setAnimation(0,"atkR",!1),this.GetSkeleton("flower1").setAnimation(1,"idleR",!0),this.curplayani="idleR"):(this.GetSkeleton("flower1").setAnimation(0,"atkL",!1),this.GetSkeleton("flower1").setAnimation(1,"idleL",!0),this.curplayani="idleL"))}},r([_(cc.Prefab)],e.prototype,"bullet_pre",void 0),r([m],e)}(l.default);i.default=y,cc._RF.pop()},{"../../resources/prefab/Bullet":void 0,"../framwork/BaseUI":"BaseUI","../manager/Data":"Data","../utils/Utils":"Utils","./DB":"DB","./HallScene":"HallScene"}],UserModel:[function(t,e,i){"use strict";cc._RF.push(e,"e5755yzM1lE0roEui3wv0BT","UserModel");var o=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var n=t("../event/GameEvent"),r=t("../manager/Data"),a=t("../utils/Utils"),s=t("./GameConst"),c=t("./DB"),l=t("../utils/AudioMgr"),u=[];function h(t,e){u.push(e)}var d=cc._decorator,p=d.ccclass,f=(d.property,function(){function t(){this.nickName="",this.avatarUrl="",this.openid="",this.auto_com_time=0,this.double_att_time=0,this.double_income_time=0,this.drop_plant_time=0,this.slots=[1,1,1,1,1,0,0,0,0,0,0,0],this.lv=1,this.wave=1,this.DropGiftPts=[],this.AdBuyNotDrop=[],this._coin=1e3,this._gem=200,this._serverTime=0,this.guideIndex=0,this.plantBuyTimes={},this.todayComTimes=0,this.ComPlants=[{open:1,index:0,lv:1}]}return t.prototype.T=function(){for(var t=this.GetMaxLv(),e=c.DB_shopSort[t+""],i=1;i<=8;++i)if("AD"==e[i])return t-i;return t-4},t.prototype.getOfflineEarning=function(t){for(var e=null,i=[50,30,20,15,10,5,3,2],o=Math.max(1,this.T()),n=this.GetMaxLv(),r=Math.max(1,o-10);r<=o;++r){var a=this.BuyPrice(r);(!e||a>e)&&(e=a)}var s=e/3e3;s<1&&(s=1);var c=Math.floor(t/60),l=t%60/60,u=0;for(r=0;r<=c;++r){var h=i[r]||1;u+=r==c?60*s*h*100*l/100:60*s*h}for(var d=0,p=0,f=this.ComPlants;p<f.length;p++){var m=f[p],_=m.lv;m.lv>0&&(d+=1e4*u/(1e4*Math.pow(2.1,Math.max(0,n-_))))}return d},Object.defineProperty(t.prototype,"coin",{get:function(){return Math.floor(100*this._coin)/100},set:function(t){this._coin=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gem",{get:function(){return this._gem},set:function(t){this._gem=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverTime",{get:function(){return this._serverTime},set:function(t){this._serverTime=t},enumerable:!1,configurable:!0}),t.prototype.getPlantInfo=function(t){for(var e=0;e<this.ComPlants.length;++e)if(this.ComPlants[e].index==t)return this.ComPlants[e];return null},t.prototype.GetMaxLv=function(){for(var t=0,e=0;e<this.ComPlants.length;++e)this.ComPlants[e].lv>t&&(t=this.ComPlants[e].lv);return t},t.prototype.BuyPrice=function(t){var e=Number(c.DB_plant[t-1][5]),i=this.plantBuyTimes[t]||0;return 1==t?1e4*e*Math.pow(1.07,i)/1e4:1e4*e*Math.pow(1.175,i)/1e4},t.prototype.CompMove=function(t,e){var i=this.getPlantInfo(t),o=this.getPlantInfo(e);i&&o?(i.index=e,o.index=t):(i&&(i.index=e),o&&(o.index=t))},t.prototype.ComposePlant=function(t,e){var i=this.ComPlants.find(function(e){return e.index==t});if(!i)return!1;var o=this.ComPlants.find(function(t){return t.index==e});if(!o)return!1;if(i.lv!=o.lv)return console.log(i,o),console.error("err"),!1;for(var r=this.GetMaxLv(),u=this.getPlantInfo(t),h=u.lv,d=0;d<this.ComPlants.length;++d)if(this.ComPlants[d].index==t){this.ComPlants.splice(d,1);break}for(d=0;d<this.ComPlants.length;++d)if(this.ComPlants[d].index==e){this.ComPlants.splice(d,1);break}this.ComPlants.push({open:u.open,index:t,lv:h+1}),this.todayComTimes++;var p=this.GetMaxLv();return p>r&&p<c.MAX_PLANT&&(console.log("\u65b0\u690d\u7269     "),a.default.createUI("prefab/NewPlantUI"),n.default.Instance().dispatch(s.default.NEW_PLANT,p)),l.default.Instance().playSFX("merge_success"),!0},t.prototype.BuyPlant=function(t,e){if(this.plantBuyTimes[e]||(this.plantBuyTimes[e]=0),this.plantBuyTimes[e]++,!this.ComPlants.find(function(t){t.index})){var i={open:1,index:t,lv:e};return this.ComPlants.push(i),r.default.save(),i}console.error("\u7d22\u5f15\u9519\u8bef")},t.prototype.DropPlant=function(t){console.log("DropPlant",t);for(var e=0;e<this.ComPlants.length;++e)if(this.ComPlants[e].index==t){var i=this.BuyPrice(this.ComPlants[e].lv);r.default.user.coin+=Math.floor(i),cc.log("\u5356\u4e86\u6362\u94b1\uff1a"+i),this.ComPlants.splice(e,1);break}},t.prototype.getUploadData=function(){var t={};this.serverTime=a.default.getServerTime();for(var e=0;e<u.length;++e)t[u[e]]=this[u[e]];return t},t.prototype.setData=function(t){if(t)for(var e=0;e<u.length;++e){var i=t[u[e]];if(null!=i||null!=i)if("[object Object]"==Object.prototype.toString.call(i))for(var o in i)this[u[e]][o]=i[o];else this[u[e]]=i}},o([h],t.prototype,"nickName",void 0),o([h],t.prototype,"avatarUrl",void 0),o([h],t.prototype,"openid",void 0),o([h],t.prototype,"auto_com_time",void 0),o([h],t.prototype,"double_att_time",void 0),o([h],t.prototype,"double_income_time",void 0),o([h],t.prototype,"drop_plant_time",void 0),o([h],t.prototype,"slots",void 0),o([h],t.prototype,"lv",void 0),o([h],t.prototype,"wave",void 0),o([h],t.prototype,"DropGiftPts",void 0),o([h],t.prototype,"AdBuyNotDrop",void 0),o([h],t.prototype,"_coin",void 0),o([h],t.prototype,"_gem",void 0),o([h],t.prototype,"_serverTime",void 0),o([h],t.prototype,"guideIndex",void 0),o([h],t.prototype,"plantBuyTimes",void 0),o([h],t.prototype,"todayComTimes",void 0),o([h],t.prototype,"ComPlants",void 0),o([p],t)}());i.default=f,cc._RF.pop()},{"../event/GameEvent":"GameEvent","../manager/Data":"Data","../utils/AudioMgr":"AudioMgr","../utils/Utils":"Utils","./DB":"DB","./GameConst":"GameConst"}],Utils:[function(t,e,i){"use strict";cc._RF.push(e,"ff748PS7+hEIIiRCFvCwbSy","Utils"),Object.defineProperty(i,"__esModule",{value:!0}),i.EFLY_TYPE=void 0;var o=t("./Shake"),n=t("../framwork/BaseUI"),r=t("./BigNumber"),a=t("../manager/PoolMgr"),s=t("../game/HallScene");(function(t){t[t["\u91d1\u5e01"]=0]="\u91d1\u5e01",t[t["\u4f53\u529b"]=1]="\u4f53\u529b",t[t["\u94bb\u77f3"]=2]="\u94bb\u77f3"})(i.EFLY_TYPE||(i.EFLY_TYPE={}));var c=function(){function t(){}return t.createUI=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=null),new Promise(function(o,n){cc.loader.loadRes(t,cc.Prefab,function(r,a){if(r)return console.error(r),void n();null==e&&(e=cc.find("Canvas"));var s=t.lastIndexOf("/"),c=t.substr(s+1,t.length-s);if(e.getComponentInChildren(c))console.log("\u91cd\u590dUI\u8df3\u8fc7");else{var l=cc.instantiate(a);l.opacity=0,l.runAction(cc.sequence(cc.delayTime(.01),cc.callFunc(function(){l.opacity=255}))),l.parent=e,i&&i(l),o(l)}})})},t.createPrefab=function(t,e,i,o){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===o&&(o=null),new Promise(function(n,r){cc.loader.loadRes(t,cc.Prefab,function(t,a){if(t)return console.error(t),void r();null==e&&(e=cc.find("Canvas"));var s=cc.instantiate(a);s.opacity=0,s.runAction(cc.sequence(cc.delayTime(.01),cc.callFunc(function(){s.opacity=255}))),s.parent=e,o&&(s.position=o),i&&i(s),n(s)})})},t.closeAllUI=function(){for(var t=cc.find("Canvas"),e=0;e<t.childrenCount;++e){var i=t.children[e].getComponent(n.default);i&&i.closeUI()}},t.getRandom=function(t,e){return Math.random()*(e-t)+t},t.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t))+t},t.seedRandomInt=function(e,i){return t.getRandomInt(e,i)},t.formatNumber=function(t,e){return void 0===e&&(e=1),t=Math.floor(t),r.default.getLargeString(t)},t.getPowNum=function(t){return Math.pow(10,t)},t.setServerTime=function(e){t.timeOffset=e-(new Date).getTime(),cc.log("timeOffset:",t.timeOffset)},t.getServerTime=function(){return(new Date).getTime()+t.timeOffset},t.Shake=function(t,e,i){var n=cc.find("Canvas/Main Camera");n.x=0,n.y=0,n.stopAllActions(),n.runAction(o.Shake.create(t,e,i))},t.addClickEvent=function(t,e,i,o,n){var r=new cc.Component.EventHandler;r.target=e,r.component=i,r.handler=o,n&&(r.customEventData=n);var a=t.getComponent(cc.Button).clickEvents;a.length>0?cc.warn("\u6309\u94ae\u5df2\u7ecf\u5b58\u5728\u7ed1\u5b9a\uff0c\u8df3\u8fc7\u81ea\u52a8\u7ed1\u5b9a",t.name):(console.log(t.name,e.name,i),a.push(r))},t.getTimeStrByS=function(t){(t=Math.floor(t))<0&&(t=0);var e=Math.floor(t/3600/24);t-=86400*e;var i=Math.floor(t/3600);t-=3600*i;var o,n=Math.floor(t/60);o=n>9?""+n:"0"+n;var r;return r=(t-=60*n)>9?""+t:"0"+t,e>0?e+"\u5929"+i+"\u65f6"+n+"\u5206":i>0?(i>9?""+i:"0"+i)+":"+o:o+":"+r},t.formatCoin=function(t){return t=Math.floor(t),r.default.getLargeString(t)},t.loadRes=function(t,e){return new Promise(function(i,o){cc.loader.loadRes(t,e,function(e,n){e?(cc.error(t,e),o(null)):i(n)})})},t.weight=function(t){for(var e=0,i=0;i<t.length;++i)e+=t[i];if(e<=0)return-1;var o=Math.round(Math.random()*Number.MAX_VALUE)%e;for(i=0;i<t.length;++i){if(o<t[i])return i;o-=t[i]}return-1},t.fixFloat=function(t,e){void 0===e&&(e=2);var i=100*e;return Math.floor(t*i)/i},t.flyAnim=function(e,i,o,n,r,c){for(var l=function(t){return 0==t?a.default.Instance().get("Coin"):1==t?a.default.Instance().get("Gem"):void 0},u=i.parent.convertToWorldSpaceAR(i.position),h=function(t,e,i,o){for(var n=[],r=Math.PI/180*Math.round(360/o),a=0;a<o;a++){var s=e+t*Math.sin(r*a),c=i+t*Math.cos(r*a);n.unshift(cc.v2(s,c))}return n}(r,(u=cc.find("Canvas").convertToNodeSpaceAR(u)).x,u.y,n),d=new Array,p=0;p<h.length;p++){var f=l(e);f.parent=cc.find("Canvas");var m=cc.v2(h[p].x+t.getRandomInt(0,50),h[p].y+t.getRandomInt(0,50));f.setPosition(u),d.push({gold:f,randPos:m})}var _=!1,y=s.default.Instance.GetGameObject(o),v=y.parent.convertToWorldSpaceAR(y.position);v=cc.find("Canvas").convertToNodeSpaceAR(v);var g=y;for(p=0;p<d.length;p++){var b=d[p].randPos,M=d[p].gold;d[p].gold.id=p;var T=cc.sequence(cc.moveTo(.2,b),cc.delayTime(.03*p),cc.moveTo(.5,cc.v2(v.x,v.y)),cc.callFunc(function(t){if(!_){g.stopAllActions(),g.setScale(1),_=!0;var e=cc.sequence(cc.scaleTo(.1,2,2),cc.scaleTo(.1,1,1),cc.callFunc(function(){_=!1}));g.runAction(e)}c(t.id==d.length-1),a.default.Instance().put(t.name,t)}));M.runAction(T)}},t.timeOffset=0,t}();i.default=c,cc._RF.pop()},{"../framwork/BaseUI":"BaseUI","../game/HallScene":"HallScene","../manager/PoolMgr":"PoolMgr","./BigNumber":"BigNumber","./Shake":"Shake"}]},{},["GameEvent","BaseUI","List","ListItem","MsgHints","DB","GameConst","HallScene","SlotItem","SoldierItem","UserModel","ConfigManager","Data","DataManager","PoolMgr","Singleton","AudioMgr","BigNumber","DebugTools","HTTP","LongTouchComponent","NumberRoll","Shake","Utils"]);